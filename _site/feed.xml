<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2021-02-09T14:37:37+01:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">LabVL</title><subtitle>Welcome in my lab !</subtitle><author><name>Valentin LÉPINE</name></author><entry><title type="html">How to synchronize Active Directory with Azure Active Directory</title><link href="http://localhost:4000/azure/azure-sync-ad-with-azure-ad/" rel="alternate" type="text/html" title="How to synchronize Active Directory with Azure Active Directory" /><published>2020-12-16T00:00:00+01:00</published><updated>2020-12-16T00:00:00+01:00</updated><id>http://localhost:4000/azure/azure-sync-ad-with-azure-ad</id><content type="html" xml:base="http://localhost:4000/azure/azure-sync-ad-with-azure-ad/">&lt;p class=&quot;text-justify&quot;&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/logo-azure-ad-222x150.png&quot; alt=&quot;image-left&quot; class=&quot;align-left&quot; /&gt;
&lt;strong&gt;Azure Active Directory&lt;/strong&gt; (Azure AD) is Microsoft’s cloud-based identity and access management service. It allows your employees to connect and access the following resources such as &lt;strong&gt;Microsoft 365&lt;/strong&gt;, &lt;strong&gt;Azure portal&lt;/strong&gt;, &lt;strong&gt;SaaS applications&lt;/strong&gt;. In particular, it makes it possible to set up a single and simplified authentication for access to company resources, to set up &lt;strong&gt;conditional access&lt;/strong&gt; and &lt;strong&gt;multi-factor authentication (MFA)&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;1-concept&quot;&gt;1 Concept&lt;/h2&gt;

&lt;h3 id=&quot;11-azure-active-directory&quot;&gt;1.1 Azure Active Directory&lt;/h3&gt;
&lt;p class=&quot;text-justify&quot;&gt;Azure Active Directory is Microsoft’s enterprise cloud-based &lt;strong&gt;identity and access management (IAM)&lt;/strong&gt; solution. &lt;strong&gt;Azure AD Domain Services&lt;/strong&gt; is a &lt;strong&gt;PaaS&lt;/strong&gt; Offering provided by Microsoft Azure. It provides seamless access, easy collaboration and improved security and compliance.&lt;br /&gt;
Azure Active Directory was originally designed as an add-on service to &lt;strong&gt;Active Directory&lt;/strong&gt; on-premise. Its functionality has been gradually expanded to include services that support &lt;strong&gt;LDAP&lt;/strong&gt; and &lt;strong&gt;LDAPS&lt;/strong&gt;, &lt;strong&gt;Multi-Factor Authentication (MFA)&lt;/strong&gt;, and many others. &lt;br /&gt;
Today companies use it to access Cloud technologies such as &lt;strong&gt;Teams&lt;/strong&gt;, &lt;strong&gt;Microsoft 365&lt;/strong&gt;, &lt;strong&gt;OneDrive&lt;/strong&gt;. It complements an on-premise &lt;strong&gt;Active Directory&lt;/strong&gt; and enables the extension of services through the Cloud.&lt;br /&gt;
Here are the two portals providing access to the Azure AD service :&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://portal.azure.com/&quot;&gt;https://portal.azure.com/&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://aad.portal.azure.com/&quot;&gt;https://aad.portal.azure.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;111-authentication-protocols&quot;&gt;1.1.1 Authentication protocols&lt;/h4&gt;

&lt;p class=&quot;text-justify&quot;&gt;Azure Active Directory supports several of the most widely used authentication protocols. Here is an exhaustive list of the main ones :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Security_Assertion_Markup_Language&quot;&gt;SAML (Security Assertion Markup Language)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/OAuth&quot;&gt;OAuth&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/OpenID&quot;&gt;OpenID&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/WS-Federation&quot;&gt;WS-Federation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;112-azure-active-directory-multi-factor-authentication&quot;&gt;1.1.2 Azure Active Directory Multi-Factor Authentication&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Multi-Factor authentication (MFA)&lt;/strong&gt; is a process in which a user is prompted during a login event to use additional forms of identification. When you require a second form of authentication, security is increased because this additional factor is not something that is easily obtained or duplicated by an attacker. Multi-factor authentication is based on two or three of the three authentication factors :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Something you know :&lt;/strong&gt; a password.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Something you have :&lt;/strong&gt; a phone number.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Something you are :&lt;/strong&gt; biometry.&lt;/li&gt;
&lt;/ul&gt;

&lt;p class=&quot;notice--success text-justify&quot;&gt;&lt;i class=&quot;fas fa-lightbulb&quot;&gt;&lt;/i&gt; &lt;strong&gt;Advice&lt;/strong&gt; &lt;br /&gt;
Microsoft recommends the activation of Multi-factor Authentication with a minimum of 2 factors for users, including high-privilege accounts or user with positions of responsibility, such as administrators, managers and chief executive officer.&lt;/p&gt;

&lt;h4 id=&quot;113-licences&quot;&gt;1.1.3 Licences&lt;/h4&gt;

&lt;ul class=&quot;text-justify&quot;&gt;
  &lt;li&gt;&lt;strong&gt;Azure Active Directory Free&lt;/strong&gt; : provides user and group management, local directory synchronization, basic reporting, self-service password changes for cloud users, and single sign-on on Azure, Microsoft 365 and many popular SaaS applications.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;text-justify&quot;&gt;
  &lt;li&gt;&lt;strong&gt;Azure Active Directory Premium P1&lt;/strong&gt; : in addition to Free features, the P1 license gives your hybrid users access to local and cloud resources. It also supports advanced administrative features, including dynamic groups, self-service group management, Microsoft Identity Manager (a local identity and access management suite) and cloud write-back (to give your local users the benefit of self-service password resets).&lt;/li&gt;
&lt;/ul&gt;
&lt;ul class=&quot;text-justify&quot;&gt;
  &lt;li&gt;&lt;strong&gt;Azure Active Directory Premium P2&lt;/strong&gt; : in addition to the Free and P1 features, the P2 license offers Azure Active Directory Identity Protection to provide risk-based conditional access to your critical business applications and data. It also offers Privileged Identity Management to make it easy for administrators to discover, restrict, monitor and access resources and, if necessary, provide just-in-time access.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Source : &lt;a href=&quot;https://azure.microsoft.com/en-us/pricing/details/active-directory/&quot;&gt;https://azure.microsoft.com/en-us/pricing/details/active-directory/&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;12-difference-between-active-directory-and-azure-active-directory&quot;&gt;1.2 Difference between Active Directory and Azure Active Directory&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Azure Active Directory&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Active Directory Domain Services&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;User and computer registration&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;User and computer registration&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Does not provide group policies&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Provides group policies&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;No trust relationships&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Can create trusts&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Application management&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Application and device management and deployment&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Single sign on&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Kerberos and NTLM support&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Schema management&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt; &lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Hierrarchical directory service&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;2-how-hybrid-identity-works&quot;&gt;2 How Hybrid Identity works&lt;/h2&gt;

&lt;h3 id=&quot;21-hybrid-identity-diagram&quot;&gt;2.1 Hybrid Identity Diagram&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/diagram-ad-azure-ad-sync.jpg&quot; alt=&quot;image-center&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Every two minutes, the password hash synchronization agent on the AD Connect server requests stored password hashes with the &lt;a href=&quot;https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/6e803168-f140-4d23-b2d3-c3a8ab5917d2&quot;&gt;unicodePwd&lt;/a&gt; attribute to the domain controller. This request uses the &lt;a href=&quot;https://docs.microsoft.com/en-us/compliance/regulatory/gdpr-manage-gdpr-data-subject-requests-with-the-dsr-case-tool&quot;&gt;MS-DRSR&lt;/a&gt; replication protocol.&lt;/li&gt;
  &lt;li&gt;Before sending, the domain controller encrypts the &lt;a href=&quot;https://en.wikipedia.org/wiki/MD4&quot;&gt;MD4&lt;/a&gt; password hash using a key that is an &lt;a href=&quot;https://en.wikipedia.org/wiki/MD5&quot;&gt;MD5&lt;/a&gt; hash of the RPC session key and a salt. It then sends the result to the password hash synchronization agent via RPC. The Domain Controller also passes the salt to the synchronization agent using the Domain Controller replication protocol, so that the agent can decrypt the envelope.
3 . Once the Password Hash Synchronization Agent has the encrypted envelope, it uses &lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.md5cryptoserviceprovider?view=net-5.0&quot;&gt;MD5CryptoServiceProvider&lt;/a&gt; and the salt to generate a key to decrypt the received data in its original &lt;a href=&quot;https://en.wikipedia.org/wiki/MD4&quot;&gt;MD4&lt;/a&gt; format. The password hash synchronization agent never has access to the plain text password.&lt;/li&gt;
  &lt;li&gt;The password hash synchronization agent extends the binary password hash from 16 bytes to 64 bytes by first converting the hash to a 32-byte hexadecimal string and then reconverting this string to binary format with &lt;a href=&quot;https://en.wikipedia.org/wiki/UTF-16&quot;&gt;UTF-16&lt;/a&gt; encoding.&lt;/li&gt;
  &lt;li&gt;The password hash synchronization agent adds for each user a 10-byte long salt to the 64-byte binary file to enhance the protection of the original hash.&lt;/li&gt;
  &lt;li&gt;The password hash synchronization agent then combines the &lt;a href=&quot;https://en.wikipedia.org/wiki/MD4&quot;&gt;MD4&lt;/a&gt; hash and the user salt and places it all into the &lt;a href=&quot;https://en.wikipedia.org/wiki/PBKDF2&quot;&gt;PBKDF2&lt;/a&gt; function. 1,000 iterations of the &lt;a href=&quot;https://en.wikipedia.org/wiki/HMAC&quot;&gt;HMAC-SHA256&lt;/a&gt; key hash algorithm are used.&lt;/li&gt;
  &lt;li&gt;The password hash synchronization agent takes the resulting 32-byte hash, concatenates the salt per user and the number of iterations &lt;a href=&quot;https://en.wikipedia.org/wiki/SHA-2&quot;&gt;SHA256&lt;/a&gt; (for use by Azure AD), and then transmits the string from Azure AD Connect to Azure AD via &lt;a href=&quot;https://en.wikipedia.org/wiki/Transport_Layer_Security&quot;&gt;TLS&lt;/a&gt;.&lt;/li&gt;
  &lt;li&gt;When a user attempts to log in to Azure AD and enters their password, the password is processed by the same MD4+salt+PBKDF2+HMAC-SHA256 process. If the resulting hash matches the hash stored in Azure AD, the user has entered the correct password and is authenticated.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;em&gt;Source : &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-password-hash-synchronization&quot;&gt;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-password-hash-synchronization&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;22-required-ports-and-protocols&quot;&gt;2.2 Required Ports and Protocols&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/diagram-ad-azure-ad-sync-required-ports-protocols.jpg&quot; alt=&quot;image-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Table 1&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Protocol&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Ports&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;DNS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;53 (TCP/UDP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;DNS lookups on the destination forest.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Kerberos&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;88 (TCP/UDP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Kerberos authentication to the AD forest.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;MS-RPC&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;135 (TCP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Used during the initial configuration of the Azure AD Connect wizard when it binds to the AD forest, and also during Password synchronization.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;LDAP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;389 (TCP/UDP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Used for data import from AD. Data is encrypted with Kerberos Sign &amp;amp; Seal.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;SMB&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;445 (TCP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Used by Seamless SSO to create a computer account in the AD forest.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;LDAP/SSL&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;636 (TCP/UDP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Used for data import from AD. The data transfer is signed and encrypted. Only used if you are using TLS.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;RPC&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;49152- 65535 (Random high RPC Port)(TCP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Used during the initial configuration of Azure AD Connect when it binds to the AD forests, and during Password synchronization.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;WinRM&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;5985 (TCP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Only used if you are installing AD FS with gMSA by Azure AD Connect Wizard.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;AD DS Web Services&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;9389 (TCP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Only used if you are installing AD FS with gMSA by Azure AD Connect Wizard.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;Table 2&lt;/strong&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Protocol&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Ports&lt;/th&gt;
      &lt;th style=&quot;text-align: left&quot;&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;HTTP&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;80 (TCP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Used to download CRLs (Certificate Revocation Lists) to verify TLS/SSL certificates.&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;HTTPS&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;443 (TCP)&lt;/td&gt;
      &lt;td style=&quot;text-align: left&quot;&gt;Used to synchronize with Azure AD.&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;em&gt;Source : &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/reference-connect-ports&quot;&gt;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/reference-connect-ports&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&quot;3-preparation&quot;&gt;3 Preparation&lt;/h2&gt;

&lt;h3 id=&quot;31-how-to-add-custom-domain-name-to-azure-active-directory&quot;&gt;3.1 How to add custom domain name to Azure Active Directory&lt;/h3&gt;

&lt;p class=&quot;text-justify&quot;&gt;Open a &lt;strong&gt;Browser&lt;/strong&gt;, go to &lt;strong&gt;&lt;a href=&quot;https://portal.azure.com/&quot;&gt;https://portal.azure.com/&lt;/a&gt;&lt;/strong&gt; and logon with your &lt;strong&gt;“Global Administrator Account”&lt;/strong&gt;.&lt;br /&gt;
In left, on the &lt;strong&gt;“Portal Menu”&lt;/strong&gt; click on &lt;strong&gt;“Azure Active Directory”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-01.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In the second bar click on &lt;strong&gt;“Custom domain names”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-02.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Click on &lt;strong&gt;”+ Add custom domain”&lt;/strong&gt;, fill in the field &lt;strong&gt;“Custom domain name *“&lt;/strong&gt; your public domain, for me &lt;strong&gt;“corporate.ovh”&lt;/strong&gt; and click on &lt;strong&gt;“Add domain”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-03.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;You will see a notification we say said &lt;strong&gt;“Domain name added”&lt;/strong&gt;, after copy the content of fields &lt;strong&gt;“Alias or hoste name”&lt;/strong&gt;, &lt;strong&gt;“Destionation or point to address”&lt;/strong&gt; and &lt;strong&gt;“TTL”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-04.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Go to your provider who register your domain name, for me it’s &lt;a href=&quot;https://www.ovh.com/manager&quot;&gt;OVH&lt;/a&gt;.&lt;br /&gt;
Select your domain, for me &lt;strong&gt;“corporate.ovh”&lt;/strong&gt;, select &lt;strong&gt;“DNS zone”&lt;/strong&gt; and &lt;strong&gt;“Add an entry”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-05.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Select &lt;strong&gt;“TXT”&lt;/strong&gt; records type.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-06.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In the field &lt;strong&gt;“Sub-domaine”&lt;/strong&gt; leave a blank. In the field &lt;strong&gt;“TTL”&lt;/strong&gt; copy your value &lt;strong&gt;“3600”&lt;/strong&gt;, in the field &lt;strong&gt;“Value *“&lt;/strong&gt; copy your value &lt;strong&gt;“MS=ms54677804”&lt;/strong&gt;. Click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-07.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Click on &lt;strong&gt;“Confirm”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-08.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;You will see the record has been added &lt;strong&gt;“The entry has been added to the DNS zone.”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-09.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Go back to &lt;strong&gt;Azure Portal&lt;/strong&gt; and click on &lt;strong&gt;“Verify”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-10.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;You will see a notification we say said &lt;strong&gt;“Verifiy domain name”&lt;/strong&gt; successfully, click on &lt;strong&gt;“Make primary”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-11.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Click on &lt;strong&gt;“Yes”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-12.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;You will see a notification we say said &lt;strong&gt;“Domain name made primary”&lt;/strong&gt;, click on tenant, for me &lt;strong&gt;“Contoso”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-13.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;You will see your domain &lt;strong&gt;corporate.ovh&lt;/strong&gt; is &lt;strong&gt;Verified&lt;/strong&gt; and the &lt;strong&gt;Primary&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-14.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;32-add-upn-in-active-directory&quot;&gt;3.2 Add UPN in Active Directory&lt;/h3&gt;

&lt;p class=&quot;text-justify&quot;&gt;In your Active Directory domain controller, for me &lt;strong&gt;“CORPWADS1”&lt;/strong&gt;.&lt;br /&gt;
Open &lt;strong&gt;“Start Menu”&lt;/strong&gt;, expand &lt;strong&gt;“Windows Administrative Tools”&lt;/strong&gt; folder, open &lt;strong&gt;“Active Directory Domains and Trusts”&lt;/strong&gt; console.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-15.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;On the left bar, click right on &lt;strong&gt;Active Directory Domains and Trusts&lt;/strong&gt;, and select &lt;strong&gt;“Properties”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-16.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;On the field &lt;strong&gt;“Alternative UPN suffices:”&lt;/strong&gt; fill in your domain name &lt;strong&gt;“corporate.ovh”&lt;/strong&gt;, click on &lt;strong&gt;“Add”&lt;/strong&gt; and click on &lt;strong&gt;“OK”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-17.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Open &lt;strong&gt;“Active Directory Users and Computers”&lt;/strong&gt; console.&lt;br /&gt; 
Go to your users OU, for me &lt;strong&gt;“corp.priv/CORP/Sites/Paris/Users”&lt;/strong&gt;, select all users, click right and select &lt;strong&gt;“Properties”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-18.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Select &lt;strong&gt;“Account”&lt;/strong&gt; tab. Check &lt;strong&gt;“UPN suffix:”&lt;/strong&gt; box, select your UPN &lt;strong&gt;“@corporate.ovh”&lt;/strong&gt;.&lt;br /&gt; 
Click on &lt;strong&gt;“OK”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-19.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;4-install-and-configuration-dazure-active-directory-connect&quot;&gt;4 Install and configuration d’Azure Active Directory Connect&lt;/h2&gt;

&lt;h3 id=&quot;41-create-service-account-in-active-directory-for-synchronisation&quot;&gt;4.1 Create service account in Active Directory for synchronisation&lt;/h3&gt;

&lt;p class=&quot;text-justify&quot;&gt;In your Active Directory domain controller, for me &lt;strong&gt;“CORPWADS1”&lt;/strong&gt;.&lt;br /&gt;
Open &lt;strong&gt;“Start Menu”&lt;/strong&gt;, expand &lt;strong&gt;“Windows Administrative Tools”&lt;/strong&gt; folder, open &lt;strong&gt;“Active Directory Users and Computers”&lt;/strong&gt; console.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-24.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;On the top bar, click on &lt;strong&gt;“Action”&lt;/strong&gt;, select &lt;strong&gt;“New &amp;gt;”&lt;/strong&gt; and click on &lt;strong&gt;“User”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-25.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In field &lt;strong&gt;“First name:”&lt;/strong&gt; fill in &lt;strong&gt;“svc_az_sync_aad”&lt;/strong&gt;, in field &lt;strong&gt;“User logon name:”&lt;/strong&gt; fill in &lt;strong&gt;“svc_az_sync_aad”&lt;/strong&gt;. Click on &lt;strong&gt;“Next &amp;gt;”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-26.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In field &lt;strong&gt;“Password:”&lt;/strong&gt; fill in with a strong password and repeat it in &lt;strong&gt;“Cofirm password:”&lt;/strong&gt;. Check &lt;strong&gt;“User cannot change password”&lt;/strong&gt; box and check &lt;strong&gt;“Password never expires”&lt;/strong&gt;.&lt;br /&gt; Click on &lt;strong&gt;“Next &amp;gt;”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-27.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Click on &lt;strong&gt;“Finish”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-28.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;42-install-azure-active-directory-connect&quot;&gt;4.2 Install Azure Active Directory Connect&lt;/h3&gt;

&lt;p class=&quot;text-justify&quot;&gt;In your &lt;strong&gt;Active Directory domain controller&lt;/strong&gt;, download &lt;strong&gt;&lt;a href=&quot;https://aka.gd/2FqW1up&quot;&gt;Microsoft Azure Active Direcotry Connect&lt;/a&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-20.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Run &lt;strong&gt;“AzureADConnect.msi”&lt;/strong&gt; and install it. After launch &lt;strong&gt;“Azure AD Connect”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-21.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Welcome :&lt;/strong&gt; check &lt;strong&gt;“I agree to the licence terms and privacy notice.”&lt;/strong&gt; and click on &lt;strong&gt;“Continue”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-22.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Required Components :&lt;/strong&gt; check the box &lt;strong&gt;“Use an existing service Account”&lt;/strong&gt;, in &lt;strong&gt;“SERVICE ACCOUNT NAME”&lt;/strong&gt; fill in prevously account &lt;strong&gt;“corp\svc_az_sync_aad”&lt;/strong&gt;, in &lt;strong&gt;“SERVICE ACCOUNT PASSWORD”&lt;/strong&gt; fill in the password account. Click on &lt;strong&gt;“Install”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-29.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;User Sign-In :&lt;/strong&gt; select &lt;strong&gt;“Password Hash Synchronization”&lt;/strong&gt; option and click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-30.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Connect to Azure AD :&lt;/strong&gt; in &lt;strong&gt;“USERNAME”&lt;/strong&gt; fill in a &lt;strong&gt;Azure AD global administrator account&lt;/strong&gt;, in &lt;strong&gt;“PASSWORD”&lt;/strong&gt; fill in the password account. Click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-31.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Connect Directories :&lt;/strong&gt; in &lt;strong&gt;“FOREST”&lt;/strong&gt; select your Active Directory Forest that you want to synchronize, for me &lt;strong&gt;“corp.priv”&lt;/strong&gt;, and click on &lt;strong&gt;“Add Directory”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-32.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;AD Forest account :&lt;/strong&gt; in &lt;strong&gt;“ENTREPRISE ADMIN USERNAME”&lt;/strong&gt; fill in a Entreprise administrator account for me &lt;strong&gt;“CORP\Administrator”&lt;/strong&gt;, in &lt;strong&gt;“PASSWORD”&lt;/strong&gt; fill in the password account. &lt;br /&gt; Click on &lt;strong&gt;“OK”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-33.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Connect Directories :&lt;/strong&gt; click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-34.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Azure AD sign-in configuration :&lt;/strong&gt; you can see, your public domain &lt;strong&gt;corporate.ovh&lt;/strong&gt; is &lt;strong&gt;Verified&lt;/strong&gt;. Because my domain Active Directory &lt;strong&gt;corp.priv&lt;/strong&gt; is not a public domain and cannot be added on Azure AD, I am forced to check the box &lt;strong&gt;“Continue without matching all UPN suffixes to verified domains”&lt;/strong&gt;. Click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-35.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Domain/OU Filtering :&lt;/strong&gt; select &lt;strong&gt;“Sync selected domains and OUs”&lt;/strong&gt;, select OUs that contain users, groups or computers that you want to synchronize. For me this one :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;corp.priv/CORP/Administrators&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;corp.priv/CORP/Groups&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;corp.priv/CORP/Sites/Paris/Computers&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;corp.priv/CORP/Sites/Paris/Groups&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;corp.priv/CORP/Sites/Paris/Users&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p class=&quot;text-justify&quot;&gt;Click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-36.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Identifying users :&lt;/strong&gt; click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-37.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Filtering :&lt;/strong&gt; click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;

&lt;p class=&quot;notice--warning text-justify&quot;&gt;&lt;i class=&quot;fas fa-exclamation-triangle&quot;&gt;&lt;/i&gt; &lt;strong&gt;Warning&lt;/strong&gt; &lt;br /&gt;
&lt;em&gt;&lt;strong&gt;“Synchronize selected :”&lt;/strong&gt; this feature is intended to support only a pilot deployment. Don’t use it in a full production deployment.”&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-38.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Optional features :&lt;/strong&gt; click on &lt;strong&gt;“Next”&lt;/strong&gt;.&lt;/p&gt;

&lt;p class=&quot;notice--info text-justify&quot;&gt;&lt;i class=&quot;fas fa-info-circle&quot;&gt;&lt;/i&gt; &lt;strong&gt;Information&lt;/strong&gt; &lt;br /&gt;
&lt;em&gt;&lt;strong&gt;Password writeback :&lt;/strong&gt; “Use this option to ensure that password changes that originate in Azure AD are written back to your on-premises directory. For more information, &lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/authentication/tutorial-enable-sspr&quot;&gt;see Getting started with password management&lt;/a&gt;.”&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-39.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Configure&lt;/strong&gt; : click on &lt;strong&gt;“Install”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-40.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Configure :&lt;/strong&gt; click on &lt;strong&gt;“Exit”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-41.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;43-check-install-and-synchronisation&quot;&gt;4.3 Check install and synchronisation&lt;/h3&gt;

&lt;h4 id=&quot;431-check-install&quot;&gt;4.3.1 Check install&lt;/h4&gt;

&lt;p&gt;The following services as been created :&lt;/p&gt;
&lt;ul class=&quot;text-justify&quot;&gt;
  &lt;li&gt;&lt;strong&gt;Microsoft Azure AD Connect Agent Updater :&lt;/strong&gt; Microsoft Azure AD Connect Agent Update Service.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Microsoft Azure AD Sync :&lt;/strong&gt; executing with &lt;strong&gt;corp\svc_az_sync_aad&lt;/strong&gt;, enables integration and management of identity information across multiple directories, systems and platforms. If this service is stopped or disabled, no synchronization or password management for objects in connected data sources will be performed.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-42.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;The following account &lt;strong&gt;MSOL_067d2d0e6b9e&lt;/strong&gt; as been created for configured to synchronize to the tenant. This account must have directory replication permissions in the local Active Directory and write permission on certain attributes to enable Hybrid Deployment.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-43.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The following services as been created :&lt;/p&gt;
&lt;ul class=&quot;text-justify&quot;&gt;
  &lt;li&gt;&lt;strong&gt;ADSyncAdmins&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ADSyncBrowse&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ADSyncOperators&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;ADSyncPasswordSet&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-44.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;The following account &lt;strong&gt;Sync_CORPWADS1_067d2d0e6b9e@M365B856048.onmicrosoft.com&lt;/strong&gt; as been created. The account is created with a long and complex password that does not expire. It is given the role of Directory Synchronization Account.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-45.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;432-check-synchronisation&quot;&gt;4.3.2 Check synchronisation&lt;/h4&gt;

&lt;p class=&quot;text-justify&quot;&gt;On the server on which &lt;strong&gt;Azure AD Connect is installed&lt;/strong&gt; is installed, for me &lt;strong&gt;“CORPWADS1”&lt;/strong&gt;.
Open &lt;strong&gt;“Start Menu”&lt;/strong&gt;, on the right open &lt;strong&gt;“Windows Powershell”&lt;/strong&gt; console.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-46.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In &lt;strong&gt;“Windows Powershell Console”&lt;/strong&gt; type the following command.&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\Users\Administrator&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Get-ADSyncScheduler&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;After running the code above, the result would show you the following:&lt;/p&gt;
&lt;ul class=&quot;text-justify&quot;&gt;
  &lt;li&gt;&lt;strong&gt;AllowedSyncCycleInterval :&lt;/strong&gt; the scheduled sync cycle interval.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SyncCycleEnabled :&lt;/strong&gt; whether the sync cycle schedule is enabled.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;NextSyncCycleStartTimeInUTC :&lt;/strong&gt; when the next sync is scheduled.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;NextSyncCyclePolicyType :&lt;/strong&gt; the type of sync that is scheduled to run next.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-47.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In &lt;strong&gt;“Windows Powershell Console”&lt;/strong&gt; type the following command.&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\Users\Administrator&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Start-ADSyncSyncCycle&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-PolicyType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Delta&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p class=&quot;text-justify&quot;&gt;After running the above command, wait for it to return the result, as shown in the image below.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-48.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Open &lt;strong&gt;“Start Menu”&lt;/strong&gt;, on the right open &lt;strong&gt;“Synchronization Service”&lt;/strong&gt; console.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-49.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In &lt;strong&gt;“Synchronization Service Manager”&lt;/strong&gt;, you can see the last operation and its associated status.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-50.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;Open a &lt;strong&gt;Browser&lt;/strong&gt;, go to &lt;strong&gt;&lt;a href=&quot;https://aad.portal.azure.com/&quot;&gt;https://aad.portal.azure.com/&lt;/a&gt;&lt;/strong&gt; and logon.&lt;br /&gt;
In left, click on &lt;strong&gt;“Users”&lt;/strong&gt;. On the &lt;strong&gt;Users | All Users&lt;/strong&gt;, you can see your users synchronized with the status &lt;strong&gt;“Yes”&lt;/strong&gt; in the column &lt;strong&gt;“Directory synced”&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-51.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In left, click on &lt;strong&gt;“Sign-ins”&lt;/strong&gt;, you can see your last synchronization.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-52.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;In left, click on &lt;strong&gt;Azure Active Directory”&lt;/strong&gt;, click on &lt;strong&gt;“Azure AD Connect”&lt;/strong&gt;, in right you can see your synchronization status.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-16-azure-sync-ad-with-azure-ad/2020-12-09-20_29_13-53.png&quot; alt=&quot;image-center&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;There you go ! You now have synchronization between &lt;strong&gt;Active Directory&lt;/strong&gt; and &lt;strong&gt;Azure Active Directory&lt;/strong&gt;.&lt;/p&gt;

&lt;p class=&quot;text-justify&quot;&gt;&lt;strong&gt;Sources :&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory-domain-services/tutorial-create-instance&quot;&gt;Tutorial: Create and configure an Azure Active Directory Domain Services managed domain&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/cloud-provisioning/tutorial-single-forest&quot;&gt;Tutorial: Integrate a single forest with a single Azure AD tenant&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-install-custom&quot;&gt;Custom installation of Azure Active Directory Connect&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/reference-connect-accounts-permissions#adsync-service-account&quot;&gt;Azure AD Connect: Accounts and permissions&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-password-hash-synchronization&quot;&gt;Implement password hash synchronization with Azure AD Connect sync&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/reference-connect-ports&quot;&gt;Hybrid Identity Required Ports and Protocols&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-sync-feature-scheduler&quot;&gt;Azure AD Connect sync: Scheduler&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Valentin LÉPINE</name></author><category term="Azure" /><category term="Azure" /><category term="Azure AD" /><category term="Azure Active Directory" /><category term="Azure AD DS" /><category term="Azure AD Domain Services" /><category term="Azure Active Directory Domain Services" /><category term="AD" /><category term="Active Directory" /><category term="Windows" /><category term="Windows Server" /><category term="Microsoft" /><category term="Security" /><category term="Services" /><category term="Server" /><category term="MFA" /><category term="Multi-Factor Authentication" /><category term="IAM" /><category term="Identity and Access Management" /><category term="LDAP" /><category term="Lightweight Directory Access Protocol" /><category term="SAML" /><category term="OAuth" /><category term="OpenID" /><category term="WS-Federation" /><category term="Domain Controller" /><category term="Azure AD Connect" /><category term="unicodePwd" /><category term="MS-DRSR" /><category term="MD4" /><category term="MD5" /><category term="MD5CryptoServiceProvider" /><category term="SHA256" /><category term="TLS" /><category term="UPN" /><category term="User Principal Name" /><category term="Identity" /><category term="DNS" /><category term="Domain" /><category term="Powershell" /><summary type="html">Azure Active Directory (Azure AD) is Microsoft’s cloud-based identity and access management service. It allows your employees to connect and access the following resources such as Microsoft 365, Azure portal, SaaS applications. In particular, it makes it possible to set up a single and simplified authentication for access to company resources, to set up conditional access and multi-factor authentication (MFA).</summary></entry><entry><title type="html">How to to configure HTTPS communication mode in System Center Configuration Manager</title><link href="http://localhost:4000/sccm/sccm-how-to-configure-HTTPS-communication/" rel="alternate" type="text/html" title="How to to configure HTTPS communication mode in System Center Configuration Manager" /><published>2020-12-05T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/sccm/sccm-how-to-configure-HTTPS-communication</id><content type="html" xml:base="http://localhost:4000/sccm/sccm-how-to-configure-HTTPS-communication/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/logo-sccm-222x150.png&quot; class=&quot;align-left&quot; /&gt;In SCCM natively, communications between clients and servers, and between servers is not secure. &lt;strong&gt;System Center Configuration Manager&lt;/strong&gt; allows to rely on a &lt;strong&gt;Public Key Infrastructure (PKI)&lt;/strong&gt; to secure an enterprise &lt;strong&gt;Certification Authority (CA)&lt;/strong&gt;. This mechanism may be required for security reasons in the implementation of a &lt;strong&gt;Cloud Management Gateway (CMG)&lt;/strong&gt;, &lt;strong&gt;Internet Based Client Management (IBCM)&lt;/strong&gt;, &lt;strong&gt;BitLocker management&lt;/strong&gt;, communication with &lt;strong&gt;MacOS clients&lt;/strong&gt;. In this article we configure the client-side HTTPS connection to the &lt;strong&gt;Management Point&lt;/strong&gt;, &lt;strong&gt;Distribution Point&lt;/strong&gt; and &lt;strong&gt;Software Update Point&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;1-create-active-directory-security-group&quot;&gt;1 Create Active Directory Security Group&lt;/h2&gt;

&lt;h3 id=&quot;11-group-for-sccm-internet-information-services-servers&quot;&gt;1.1 Group for SCCM Internet Information Services Servers&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;Active Directory domain controller&lt;/strong&gt;, for me &lt;strong&gt;&quot;CORPWADS1&quot;&lt;/strong&gt;.
&lt;br /&gt; Open &lt;strong&gt;&quot;Active Directory Users and Computers&quot;&lt;/strong&gt; console, in your OU when contain your groups, click on &lt;strong&gt;&quot;Action&lt;/strong&gt; on the top, and select &lt;strong&gt;&quot;New&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Group&quot;&lt;/strong&gt;.&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Group name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;GRP_SCCM_IIS_Servers&quot;&lt;/strong&gt; and in &lt;strong&gt;&quot;Group name (pre-Windows 2000):&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;GRP_SCCM_IIS_Servers&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_00.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Double click on the group &lt;strong&gt;&quot;GRP_SCCM_IIS_Servers&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_01.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Members&quot;&lt;/strong&gt; tab on the top, in the bottom click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_02.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Object Types...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_03.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Computers&quot;&lt;/strong&gt; box and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_04.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Enter the object names to select (examples):&quot;&lt;/strong&gt; field indicate the name of your SCCM Server &lt;strong&gt;&quot;CORPWSCM1&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Check Names&quot;&lt;/strong&gt; button. Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_05.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_06.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;12-group-for-sccm-distribution-point-server&quot;&gt;1.2 Group for SCCM Distribution Point Server&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Active Directory Users and Computers&quot;&lt;/strong&gt; console, in your OU when contain your groups, click on &lt;strong&gt;&quot;Action&lt;/strong&gt; on the top, and select &lt;strong&gt;&quot;New&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Group&quot;&lt;/strong&gt;.&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Group name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;GRP_SCCM_DP_Servers&quot;&lt;/strong&gt; and in &lt;strong&gt;&quot;Group name (pre-Windows 2000):&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;GRP_SCCM_DP_Servers&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_07.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Double click on the group &lt;strong&gt;&quot;GRP_SCCM_DP_Servers&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_08.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Members&quot;&lt;/strong&gt; tab on the top, in the bottom click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_09.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Object Types...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_10.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Computers&quot;&lt;/strong&gt; box and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_11.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Enter the object names to select (examples):&quot;&lt;/strong&gt; field indicate the name of your SCCM Server &lt;strong&gt;&quot;CORPWSCM1&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Check Names&quot;&lt;/strong&gt; button. Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_12.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_13.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;After, reboot the &lt;strong&gt;CORPWSCM1&lt;/strong&gt; server, for the change to take effect.&lt;/p&gt;

&lt;h2 id=&quot;2-create-certificate-templates-on-the-certification-authority&quot;&gt;2 Create certificate templates on the certification authority&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;Active Directory Certificate Service&lt;/strong&gt;, for me &lt;strong&gt;&quot;CORPWADS1&quot;&lt;/strong&gt;.
&lt;br /&gt; Open &lt;strong&gt;&quot;Windows Start Menu&quot;&lt;/strong&gt;, in the search bar search &lt;strong&gt;&quot;CertSrv.msc&quot;&lt;/strong&gt; console and open it.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_14.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the left bar, expand &lt;strong&gt;&quot;corpRootCA&quot;&lt;/strong&gt;, right click on &lt;strong&gt;&quot;Certificate Templates&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Manage&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_15.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;21-internet-information-services-certificate&quot;&gt;2.1 Internet Information Services Certificate&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;Certificate Templates Console&lt;/strong&gt;, at the bottom, right click on &lt;strong&gt;&quot;Web Server&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Duplicate Template&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_16.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;General&quot;&lt;/strong&gt; tab.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_17.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Template display name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;SCCM IIS Certificate&quot;&lt;/strong&gt; and in &lt;strong&gt;&quot;Template name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;SCCMIISCertificate&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_18.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Request Handling&quot;&lt;/strong&gt; tab, verify that &lt;strong&gt;&quot;Allow private key to be exported&quot;&lt;/strong&gt; is not selected.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_19.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Subject Name&quot;&lt;/strong&gt; tab, verify that &lt;strong&gt;&quot;Supply in the Request&quot;&lt;/strong&gt; is selected.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_20.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Security&quot;&lt;/strong&gt; tab, click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_21.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Enter the object names to select (examples):&quot;&lt;/strong&gt; field indicate the following name of your group &lt;strong&gt;&quot;GRP_SCCM_IIS_Servers&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Check Names&quot;&lt;/strong&gt;. Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_22.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;For the group &lt;strong&gt;&quot;GRP_SCCM_IIS_Servers&quot;&lt;/strong&gt; check the &lt;strong&gt;&quot;Read&quot;&lt;/strong&gt; and &lt;strong&gt;&quot;Enroll&quot;&lt;/strong&gt; box. Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_23.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;22-distribution-point-certificate&quot;&gt;2.2 Distribution Point Certificate&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;Certificate Templates Console&lt;/strong&gt;, at the bottom, right click on &lt;strong&gt;&quot;Workstation Authentification&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Duplicate Template&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_24.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;General&quot;&lt;/strong&gt; tab.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_25.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Template display name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;SCCM DP Certificate&quot;&lt;/strong&gt; and in &lt;strong&gt;&quot;Template name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;SCCMDPCertificate&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_26.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Request Handling&quot;&lt;/strong&gt; tab, checl the box &lt;strong&gt;&quot;Allow private key to be exported&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_27.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Security&quot;&lt;/strong&gt; tab, click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_28.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Enter the object names to select (examples):&quot;&lt;/strong&gt; field indicate the following name of your group &lt;strong&gt;&quot;GRP_SCCM_DP_Servers&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Check Names&quot;&lt;/strong&gt;. Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_29.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;For the group &lt;strong&gt;&quot;GRP_SCCM_DP_Servers&quot;&lt;/strong&gt; check the &lt;strong&gt;&quot;Read&quot;&lt;/strong&gt; and &lt;strong&gt;&quot;Enroll&quot;&lt;/strong&gt; box.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_30.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select the group &lt;strong&gt;&quot;Entreprise Admins (CORP\Entreprise Admins)&quot;&lt;/strong&gt; and click to &lt;strong&gt;&quot;Remove&quot;&lt;/strong&gt; button. Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_31.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;23-client-certificate&quot;&gt;2.3 Client Certificate&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;Certificate Templates Console&lt;/strong&gt;, at the bottom, right click on &lt;strong&gt;&quot;Workstation Authentification&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Duplicate Template&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_32.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;General&quot;&lt;/strong&gt; tab.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_33.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Template display name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;SCCM Client Certificate&quot;&lt;/strong&gt; and in &lt;strong&gt;&quot;Template name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;SCCMClientCertificate&quot;&lt;/strong&gt;, in &lt;strong&gt;&quot;Validity period:&quot;&lt;/strong&gt; field indicate &lt;strong&gt;&quot;3&quot;&lt;/strong&gt; years.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_34.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Subject Name&quot;&lt;/strong&gt; tab, checl the box &lt;strong&gt;&quot;Build from this Active Directory information&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_35.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Request Handling&quot;&lt;/strong&gt; tab, verify that &lt;strong&gt;&quot;Allow private key to be exported&quot;&lt;/strong&gt; is not selected.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_36.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Security&quot;&lt;/strong&gt; tab, for the group &lt;strong&gt;&quot;Domain Computers (CORP\Domain Computers)&quot;&lt;/strong&gt;, check the &lt;strong&gt;&quot;Read&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Enroll&quot;&lt;/strong&gt; and &lt;strong&gt;&quot;Autoenroll&quot;&lt;/strong&gt; box. Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_37.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The three SCCM templates are now shown below, close the &lt;strong&gt;Certificate Templates Console&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_38.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;3-deploy-certificates&quot;&gt;3 Deploy certificates&lt;/h2&gt;

&lt;h3 id=&quot;31-publishing-certificates-templates&quot;&gt;3.1 Publishing Certificates Templates&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Back on &lt;strong&gt;&quot;certsrv&quot;&lt;/strong&gt; console, in the left bar, right click on &lt;strong&gt;&quot;Certificate Templates&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;New&quot;&lt;/strong&gt; and on &lt;strong&gt;&quot;Certificate Template to Issue&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_39.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select your three Certificate Templates, &lt;strong&gt;&quot;SCCM Client Certificate&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;SCCM DP Certificate&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;SCCM IIS Certificate&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_40.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;32-create-gpo-autoenroll-for-computers&quot;&gt;3.2 Create GPO autoenroll for computers&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;Active Directory domain controller&lt;/strong&gt;, for me &lt;strong&gt;&quot;CORPWADS1&quot;&lt;/strong&gt;.
&lt;br /&gt; Open &lt;strong&gt;&quot;Group Policy Management&quot;&lt;/strong&gt; console, expand &lt;strong&gt;&quot;Forest: corp.priv&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Domains&quot;&lt;/strong&gt;, click right on &lt;strong&gt;&quot;corp.priv&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Create a GPO in this domain, and Link it here...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_41.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Name:&quot;&lt;/strong&gt; field indicate the following name &lt;strong&gt;&quot;C-Cert_Auto_Enrollment&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_42.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click right on your GPO &lt;strong&gt;&quot;C-Cert_Auto_Enrollment&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Edit...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_43.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On &lt;strong&gt;&quot;Group Policy Management Editor&quot;&lt;/strong&gt; console, in the left bar, expand &lt;strong&gt;&quot;Computer Configuration&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Policies&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Windows Settings&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Security Settings&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Public Key Policies&quot;&lt;/strong&gt; and on the right bar double click on &lt;strong&gt;&quot;Caertificate Services Client - Auto-Enrollment&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_44.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On the &lt;strong&gt;&quot;Configuration Model:&quot;&lt;/strong&gt; select &lt;strong&gt;&quot;Enabled&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_45.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;33-request-client-certificate-in-your-sccm-server&quot;&gt;3.3 Request client certificate in your SCCM Server&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;SCCM Server&lt;/strong&gt;, for me &lt;strong&gt;&quot;CORPWSCM1&quot;&lt;/strong&gt;.
&lt;br /&gt; Open &lt;strong&gt;&quot;Windows Start Menu&quot;&lt;/strong&gt;, open &lt;strong&gt;&quot;Command Prompt&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_46.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;Command Prompt&lt;/strong&gt;, type the command &lt;strong&gt;&quot;certlm.msc&quot;&lt;/strong&gt; and type &lt;strong&gt;&quot;Enter&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_47.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;certlm&lt;/strong&gt; console, in the left bar, expand &lt;strong&gt;&quot;Personal&quot;&lt;/strong&gt; and double click on &lt;strong&gt;&quot;Certificates&quot;&lt;/strong&gt;. &lt;br /&gt;You can see the certificates published by default for the servers.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_48.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Switch in &lt;strong&gt;Command Prompt&lt;/strong&gt;, type the command &lt;strong&gt;&quot;gpupdate /force&quot;&lt;/strong&gt; and type &lt;strong&gt;&quot;Enter&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_49.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Return to &lt;strong&gt;certlm&lt;/strong&gt; console, refresh the view, you can see the &lt;strong&gt;&quot;SCCM Client Certificate&quot;&lt;/strong&gt; template have generate the client certificat authentification certificate.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_50.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;34-request-new-certificates-in-sccm-server&quot;&gt;3.4 Request New certificates in SCCM Server&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;certlm&lt;/strong&gt; console, in the left bar, click on &lt;strong&gt;&quot;Certificates&quot;&lt;/strong&gt;, click on &lt;strong&gt;&quot;All Tasks&quot;&lt;/strong&gt; , click on &lt;strong&gt;&quot;Request New Certificate...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_51.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_52.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_53.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check &lt;strong&gt;&quot;SCCM DP Certificate&quot;&lt;/strong&gt; and &lt;strong&gt;&quot;SCCM IIS Certificate&quot;&lt;/strong&gt; box. And click on &lt;strong&gt;&quot;More information is required to enroll for this certificate. Click here to configure settings&quot;&lt;/strong&gt; link.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_54.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In &lt;strong&gt;&quot;Alternative name:&quot;&lt;/strong&gt;, in &lt;strong&gt;&quot;Type:&quot;&lt;/strong&gt; select &lt;strong&gt;&quot;DNS&quot;&lt;/strong&gt;, in &lt;strong&gt;&quot;Value:&quot;&lt;/strong&gt; fill in the DNS name of your server and click on &lt;strong&gt;&quot;Add &amp;gt;&quot;&lt;/strong&gt;. Repeat the operation with the FQDN name of your server.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_55.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;General&quot;&lt;/strong&gt; tab. In &lt;strong&gt;&quot;Friendly name:&quot;&lt;/strong&gt; fill in the following name &lt;strong&gt;&quot;SCCM IIS Cert&quot;&lt;/strong&gt;. 
&lt;br /&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_56.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Enroll&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_57.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Finish&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_58.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;You can see the &lt;strong&gt;&quot;SCCM DP Certificate&quot;&lt;/strong&gt; adn &lt;strong&gt;&quot;SCCM IIS Certificate&quot;&lt;/strong&gt; templates have generated.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_59.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;35-export-distribution-point-certificate&quot;&gt;3.5 Export Distribution Point Certificate&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click right on your &lt;strong&gt;&quot;SCCM DP Certificate&quot;&lt;/strong&gt;, select &lt;strong&gt;&quot;All Tasks&quot;&lt;/strong&gt; and click to &lt;strong&gt;&quot;Export...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_60.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_61.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Yes, export the private key&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_62.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_63.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check the &lt;strong&gt;&quot;Password:&quot;&lt;/strong&gt; box, enter a &lt;strong&gt;&quot;Password&quot;&lt;/strong&gt; and confirm it, click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_64.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Browse...&quot;&lt;/strong&gt; button and fill in the field, for me &lt;strong&gt;&quot;D:\Cert\OSD Cert.pfx&quot;&lt;/strong&gt;. Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_65.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Finish&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_66.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_67.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;4-changing-the-internet-information-services-configuration&quot;&gt;4 Changing the Internet Information Services configuration&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;SCCM Server&lt;/strong&gt;, for me &lt;strong&gt;&quot;CORPWSCM1&quot;&lt;/strong&gt;.&lt;br /&gt;
Open &lt;strong&gt;&quot;Windows Start Menu&quot;&lt;/strong&gt;, on the right, click on &lt;strong&gt;&quot;Windows Administrative Tools&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_68.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Internet Information Services (IIS) Manager&quot;&lt;/strong&gt; console.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_69.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On &lt;strong&gt;&quot;Internet Information Services (IIS) Manager&quot;&lt;/strong&gt; console, click on &lt;strong&gt;&quot;CORPWSCM1 (CORP\administrator)&quot;&lt;/strong&gt;, click on &lt;strong&gt;&quot;Sites&quot;&lt;/strong&gt;, click right on &lt;strong&gt;&quot;Default Web Site&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Edit Bindings...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_70.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;https&quot;&lt;/strong&gt; line and click on &lt;strong&gt;&quot;Edit...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_71.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Select...&quot;&lt;/strong&gt; and select on &lt;strong&gt;&quot;SSL Certificate&quot;&lt;/strong&gt; the &lt;strong&gt;&quot;SCCM IIS Cert&quot;&lt;/strong&gt; certificate and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_72.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_73.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;Internet Explorer&quot;&lt;/strong&gt;, go to the &lt;strong&gt;&quot;https://corpwscm1.corp.priv&quot;&lt;/strong&gt; site. In the right, click on &lt;strong&gt;&quot;lock icon&quot;&lt;/strong&gt;, you can see, your root certificate is &lt;strong&gt;corpRootCA&lt;/strong&gt; and the certificate is for server &lt;strong&gt;&quot;corpwscm1.corp.priv&quot;&lt;/strong&gt;. After close &lt;strong&gt;&quot;Internet Explorer&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_74.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;41-certificate-for-wsus&quot;&gt;4.1 Certificate for WSUS&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;WSUS Server&lt;/strong&gt;, for me, it is the same as the SCCM server. &lt;br /&gt;Open &lt;strong&gt;&quot;Internet Information Services (IIS) Manager&quot;&lt;/strong&gt; console, click right on &lt;strong&gt;&quot;WSUS Administration&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Edit Bindings...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_75.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;https&quot;&lt;/strong&gt; line and click on &lt;strong&gt;&quot;Edit...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_76.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Select...&quot;&lt;/strong&gt; and select on &lt;strong&gt;&quot;SSL Certificate&quot;&lt;/strong&gt; the &lt;strong&gt;&quot;SCCM IIS Cert&quot;&lt;/strong&gt; certificate and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_77.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_78.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;42-modify-wsus-internet-information-services-ssl-settings&quot;&gt;4.2 Modify WSUS Internet Information Services SSL Settings&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Expend &lt;strong&gt;&quot;WSUS Administration&quot;&lt;/strong&gt;, select &lt;strong&gt;&quot;ApiRemoting30&quot;&lt;/strong&gt;, double click on &lt;strong&gt;&quot;SSL Settings&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_79.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check &lt;strong&gt;&quot;Require SSL&quot;&lt;/strong&gt; box and on right, click on &lt;strong&gt;&quot;Apply&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_80.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;ClientWebService&quot;&lt;/strong&gt;, double click on &lt;strong&gt;&quot;SSL Settings&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_81.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check &lt;strong&gt;&quot;Require SSL&quot;&lt;/strong&gt; box and on right, click on &lt;strong&gt;&quot;Apply&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_82.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;DssAuthWebService&quot;&lt;/strong&gt;, double click on &lt;strong&gt;&quot;SSL Settings&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_83.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check &lt;strong&gt;&quot;Require SSL&quot;&lt;/strong&gt; box and on right, click on &lt;strong&gt;&quot;Apply&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_84.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;ServerSyncWebService&quot;&lt;/strong&gt;, double click on &lt;strong&gt;&quot;SSL Settings&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_85.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check &lt;strong&gt;&quot;Require SSL&quot;&lt;/strong&gt; box and on right, click on &lt;strong&gt;&quot;Apply&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_86.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;SimpleAuthWebService&quot;&lt;/strong&gt;, double click on &lt;strong&gt;&quot;SSL Settings&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_87.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check &lt;strong&gt;&quot;Require SSL&quot;&lt;/strong&gt; box and on right, click on &lt;strong&gt;&quot;Apply&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_88.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;5-configure-wsus-for-use-ssl&quot;&gt;5 Configure WSUS for use SSL&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;Windows Start Menu&quot;&lt;/strong&gt;, on the left, expand &lt;strong&gt;&quot;Windows System&quot;&lt;/strong&gt;, click on &lt;strong&gt;&quot;Command Prompt&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_89.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On &lt;strong&gt;&quot;Command Prompt&quot;&lt;/strong&gt;, use the following command :&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;C:\Users\administrator.CORP&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;cd&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\Program&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Files\Update&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Services\Tools&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_90.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On &lt;strong&gt;&quot;Command Prompt&quot;&lt;/strong&gt;, use the following command :&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;C:\Program&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Files\Update&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Services\Tools&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;WsusUtil.exe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;configuressl&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;corpwscm1.corp.priv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_91.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;6-export-your-rootca&quot;&gt;6 Export your RootCA&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;Active Directory Certificate Service&lt;/strong&gt;, for me &lt;strong&gt;&quot;CORPWADS1&quot;&lt;/strong&gt;.
&lt;br /&gt; Open &lt;strong&gt;&quot;Windows Start Menu&quot;&lt;/strong&gt;, in the search bar search &lt;strong&gt;&quot;CertSrv.msc&quot;&lt;/strong&gt; console and open it.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_92.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the left bar, right click on &lt;strong&gt;&quot;corpRootCA&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_93.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;View Cartificate&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_94.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Details&quot;&lt;/strong&gt; tab and click on &lt;strong&gt;&quot;Copy to File...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_95.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_96.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_97.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Browse...&quot;&lt;/strong&gt; and fill in the &lt;strong&gt;&quot;File name:&quot;&lt;/strong&gt; field your certificate file name &lt;strong&gt;C:\Users\Administrator\Documents\corpRootCA.cer&lt;/strong&gt;. Click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_98.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Finish&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_99.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_100.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Copy your &lt;strong&gt;corpRootCA.cer&lt;/strong&gt; in your SCCM Server.&lt;/p&gt;

&lt;h2 id=&quot;7-configure-sccm-to-use-https-client-communication&quot;&gt;7 Configure SCCM to use HTTPS client communication&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;SCCM Server&lt;/strong&gt;, for me &lt;strong&gt;&quot;CORPWSCM1&quot;&lt;/strong&gt;. Open &lt;strong&gt;&quot;Microsoft Endpoint Configuration Manager&quot;&lt;/strong&gt; console .&lt;br /&gt;
Open &lt;strong&gt;&quot;Windows Start Menu&quot;&lt;/strong&gt;, on the right, click on &lt;strong&gt;&quot;Windows Administrative Tools&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_101.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Communication Security&quot;&lt;/strong&gt; tab and click on &lt;strong&gt;&quot;Set...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_102.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on the &lt;strong&gt;Sun icon&lt;/strong&gt; and select your &lt;strong&gt;corpRootCA.cer&lt;/strong&gt; file, click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_103.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check &lt;strong&gt;&quot;HTTPS Only&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_104.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;71-configure-the-distribution-point-for-using-ssl&quot;&gt;7.1 Configure the Distribution Point for using SSL&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In left panel select &lt;strong&gt;&quot;Servers and Site System Roles&quot;&lt;/strong&gt;, on right side select your server &lt;strong&gt;&quot;\\CORPWSCM1.corp.priv&quot;&lt;/strong&gt;, click on &lt;strong&gt;&quot;Distribution point&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_105.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Communication&quot;&lt;/strong&gt; tab, check the &lt;strong&gt;&quot;Import certificate&quot;&lt;/strong&gt; box. Click on &lt;strong&gt;&quot;Browse...&quot;&lt;/strong&gt; and select the OSD certificate &lt;strong&gt;D:\Cert\OSD Cert.pxf&lt;/strong&gt; in the &lt;strong&gt;&quot;Certificate:&quot;&lt;/strong&gt;, fill in the &lt;strong&gt;&quot;Password:&quot;&lt;/strong&gt; field your certificate password and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_106.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;72-configure-the-management-point-for-using-ssl&quot;&gt;7.2 Configure the Management Point for using SSL&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Distribution point&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_107.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Verify if the &lt;strong&gt;HTTPS&lt;/strong&gt; box is selected and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_108.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;73-configure-the-software-update-point-for-using-ssl&quot;&gt;7.3 Configure the Software update Point for using SSL&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Software update point&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_109.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check the &lt;strong&gt;&quot;Require SSL communication to the WSUS server&quot;&lt;/strong&gt; box and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_110.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;74-check-the-logs&quot;&gt;7.4 Check the logs&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;D:\Program Files\Microsoft Configuration Manager\Logs\sitecomp.log&quot;&lt;/strong&gt;.
In &lt;strong&gt;sitecomp.log&lt;/strong&gt; you can see this initiated the Management Point to reinstall itself with the new settings.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_111.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;D:\Program Files\Microsoft Configuration Manager\Logs\MPSetup.log&quot;&lt;/strong&gt;.
In &lt;strong&gt;MPSetup.log&lt;/strong&gt; you can see the communication is in SSL mode.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_112.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;D:\Program Files\Microsoft Configuration Manager\Logs\mpcontrol.log&quot;&lt;/strong&gt;.
In &lt;strong&gt;mpcontrol.log&lt;/strong&gt; you can see the communication in HTTPS is OK.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_113.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;D:\Program Files\Microsoft Configuration Manager\Logs\WCM.log&quot;&lt;/strong&gt;.
In &lt;strong&gt;WCM.log&lt;/strong&gt; you can see Software Update Point reconfigure to use the communication in HTTPS.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_114.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;8-verify-client-certificate-and-ssl-communication-with-sccm&quot;&gt;8 Verify client certificate and SSL communication with SCCM&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In your &lt;strong&gt;Client&lt;/strong&gt;, for me &lt;strong&gt;&quot;WD01&quot;&lt;/strong&gt;.
&lt;br /&gt; Open &lt;strong&gt;&quot;Windows Start Menu&quot;&lt;/strong&gt;, in the search bar search &lt;strong&gt;&quot;certlm.msc&quot;&lt;/strong&gt; console and open it.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_115.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the left bar, expand &lt;strong&gt;&quot;Personal&quot;&lt;/strong&gt;, click on &lt;strong&gt;&quot;Certificates&quot;&lt;/strong&gt;. &lt;br /&gt;You can see the certificate &lt;strong&gt;&quot;SCCM Client Certificate&quot;&lt;/strong&gt; have requested by the client.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_116.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;Control Panel&quot;&lt;/strong&gt;, and open the &lt;strong&gt;&quot;Configuration Manager Client agent&quot;&lt;/strong&gt;.
&lt;br /&gt;In your &lt;strong&gt;&quot;Client certificate:&quot;&lt;/strong&gt; Property, you will see for the moment is &lt;strong&gt;&quot;Selft-signed&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_117.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Close &lt;strong&gt;&quot;Configuration Manager Client agent&quot;&lt;/strong&gt; and after couple of minutes repopen it.
&lt;br /&gt;In your &lt;strong&gt;&quot;Client certificate:&quot;&lt;/strong&gt; Property, you will see now is &lt;strong&gt;&quot;PKI&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_118.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;C:\Windows\CCM\Logs\ClientIDManagerStartup.log&quot;&lt;/strong&gt;.&lt;br /&gt;
In &lt;strong&gt;ClientIDManagerStartup.log&lt;/strong&gt; you can see Client PKI Certificate is available.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_119.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open &lt;strong&gt;&quot;C:\Windows\CCM\Logs\CcmMessaging.log&quot;&lt;/strong&gt;.&lt;br /&gt;
In &lt;strong&gt;CcmMessaging.log&lt;/strong&gt; you can see the communication is successfuly.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-12-05-sccm-how-to-configure-https-communication/2020-04-25-08_46_120.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;There you go ! Your SCCM infrastructure now uses PKI to communicate.&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Sources :&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/mem/configmgr/core/plan-design/network/pki-certificate-requirements&quot;&gt;PKI certificate requirements for Configuration Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.windows-noob.com/forums/topic/16300-how-can-i-configure-system-center-configuration-manager-in-https-mode-pki-part-1/&quot;&gt;How can I configure System Center Configuration Manager in HTTPS mode (PKI) - Part 1&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.windows-noob.com/forums/topic/16301-how-can-i-configure-system-center-configuration-manager-in-https-mode-pki-part-2/&quot;&gt;How can I configure System Center Configuration Manager in HTTPS mode (PKI) - Part 2&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.prajwaldesai.com/deploy-pki-certificates-for-sccm-2012-r2/&quot;&gt;Deploy PKI Certificates for SCCM 2012 R2 Step by Step Guide&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://gmarculescu.com/?p=81&quot;&gt;Set up HTTPS client communication with SCCM&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://danikuci.wordpress.com/2014/03/26/configuring-sccm-for-managing-macs/&quot;&gt;Configuring SCCM 2012 for PKI and SSL: Setting up HTTPS communication&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Valentin LÉPINE</name></author><category term="SCCM" /><category term="PKI" /><category term="Public Key Infrastructure" /><category term="Authoritie" /><category term="Authorities" /><category term="Certificate Authoritie" /><category term="Certificate Authorities" /><category term="CA" /><category term="Certificate" /><category term="Certificate Services" /><category term="AD CS" /><category term="Active Directory Certificate Services" /><category term="AD" /><category term="Active Directory" /><category term="Windows" /><category term="Windows Server" /><category term="Microsoft" /><category term="Security" /><category term="Services" /><category term="Server" /><category term="SCCM" /><category term="System Center" /><category term="Configuration Manager" /><category term="System Center Configuration Manager" /><summary type="html">In SCCM natively, communications between clients and servers, and between servers is not secure. System Center Configuration Manager allows to rely on a Public Key Infrastructure (PKI) to secure an enterprise Certification Authority (CA). This mechanism may be required for security reasons in the implementation of a Cloud Management Gateway (CMG), Internet Based Client Management (IBCM), BitLocker management, communication with MacOS clients. In this article we configure the client-side HTTPS connection to the Management Point, Distribution Point and Software Update Point.</summary></entry><entry><title type="html">How to install and configure certificate authorities on Windows Server</title><link href="http://localhost:4000/active%20directory/install-configure-certificate-authorities/" rel="alternate" type="text/html" title="How to install and configure certificate authorities on Windows Server" /><published>2020-11-26T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/active%20directory/install-configure-certificate-authorities</id><content type="html" xml:base="http://localhost:4000/active%20directory/install-configure-certificate-authorities/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/logo-ad-cs-222x150.png&quot; class=&quot;align-left&quot; /&gt;
The &lt;strong&gt;Active Directory Certificate Service (AD CS)&lt;/strong&gt; provides functionality for managing a &lt;strong&gt;Public Key Infrastructure (PKI)&lt;/strong&gt; that manages identities and other security features on the Windows domain. It can &lt;strong&gt;create&lt;/strong&gt;, &lt;strong&gt;validate&lt;/strong&gt;, and &lt;strong&gt;revoke&lt;/strong&gt; &lt;strong&gt;public key certificates&lt;/strong&gt; for an &lt;strong&gt;organization's internal uses&lt;/strong&gt;.&lt;!--more--&gt; It is used for the security of the following applications: Digital signatures, Secure e-mail, Internet authentication, IP security, Smart card logon, Encrypting File System user and recovery certificates, Wireless 802.1X authentication, Authentication of network devices such as routers that do not have network accounts.&lt;/p&gt;

&lt;h2 id=&quot;installation&quot;&gt;Installation&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Server Manager&quot;&lt;/strong&gt;, then click &lt;strong&gt;&quot;Manage&quot;&lt;/strong&gt; and then &lt;strong&gt;&quot;Add Roles and Features&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_04_21-0.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Before you begin :&lt;/strong&gt; the page displays a small reminder of prerequisites before a role is installed. If you want this page to no longer appear, check the case &lt;strong&gt;&quot;Skip this page by default&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_04_21-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Select installation type :&lt;/strong&gt; we want to install the role on the server in question, leave the default choice and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_13_21-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Select destination server :&lt;/strong&gt; the default choice is automatically selects our server in the pool, click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_21-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Select server roles :&lt;/strong&gt; in the list of roles, check the &lt;strong&gt;&quot;Active Directory Certificate Services&quot;&lt;/strong&gt; box. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_22-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Select server roles :&lt;/strong&gt; a window appears asking if you want to install management tools for the Active Directory Certificate Services role, click on &lt;strong&gt;&quot;Add Features&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_23-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Select server roles :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_24-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Select features :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_25-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Active Directory Certificate Services :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_26-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Select role services :&lt;/strong&gt; check the &lt;strong&gt;&quot;Certificate Authority&quot;&lt;/strong&gt; box.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_27-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Confirm installation selections :&lt;/strong&gt; click on &lt;strong&gt;&quot;Install&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_32-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Installation progress :&lt;/strong&gt; click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_33-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;configuration&quot;&gt;Configuration&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Server Manager&quot;&lt;/strong&gt;, click on &lt;strong&gt;&quot;the flag with a warning&quot;&lt;/strong&gt; and click on the link &lt;strong&gt;&quot;Configure Active Directory Certificate Services on th...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_34-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Credentials :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_35-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Role Services :&lt;/strong&gt; check the &lt;strong&gt;&quot;Certificate Authority&quot;&lt;/strong&gt; box. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_36-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Setup Type :&lt;/strong&gt; check the &lt;strong&gt;&quot;Entreprise CA&quot;&lt;/strong&gt; box. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_36-2.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;CA Type :&lt;/strong&gt; check the &lt;strong&gt;&quot;Root CA&quot;&lt;/strong&gt; box and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_37-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Private Key :&lt;/strong&gt; check the &lt;strong&gt;&quot;Create a new private key&quot;&lt;/strong&gt; box and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_38-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Cryptography for CA :&lt;/strong&gt; in the &lt;strong&gt;&quot;Key length field:&quot;&lt;/strong&gt; select &lt;strong&gt;&quot;4096&quot;&lt;/strong&gt;, in the list &lt;strong&gt;&quot;Select the hash algorithm for signing certificates issued by this CA:&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;SHA256&quot;&lt;/strong&gt;. &lt;br /&gt;Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_39-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;CA Name :&lt;/strong&gt; in the &lt;strong&gt;&quot;Common name for this CA:&quot;&lt;/strong&gt; fill in the field with the name of this CA like this &lt;strong&gt;&quot;corpRootCA&quot;&lt;/strong&gt;, in the &lt;strong&gt;&quot;Distinguished name suffix:&quot;&lt;/strong&gt; field live a blank, in the &lt;strong&gt;&quot;Preview of distinguished name:&quot;&lt;/strong&gt; fill in the field with the name of this CA like this &lt;strong&gt;&quot;CN=corpRootCA&quot;&lt;/strong&gt;. &lt;br /&gt;Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_40-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Validity Period :&lt;/strong&gt; in the &lt;strong&gt;&quot;Select the validity period for the certificate generated for this certification authority (CA):&quot;&lt;/strong&gt; fill in the field with the validity period of your certificate, I would use for my part &lt;strong&gt;&quot;5&quot;&lt;/strong&gt; Years. &lt;br /&gt;Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_41-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;CA Database :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_42-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Confirmation :&lt;/strong&gt; click on &lt;strong&gt;&quot;Configure&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_43-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Results :&lt;/strong&gt; click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-26-install-configure-certificate-authorities/2019-02-23-18_17_44-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;There you go ! Active Directory Certificate Services have been successfully installed and configured, you can now create, validate, and revoke your public key certificates for your organization's.&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Sources :&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/windows-server/networking/core-network-guide/cncg/server-certs/install-the-certification-authority&quot;&gt;Install the Certification Authority&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://social.technet.microsoft.com/wiki/contents/articles/7421.active-directory-certificate-services-ad-cs-public-key-infrastructure-pki-design-guide.aspx&quot;&gt;Active Directory Certificate Services (AD CS) Public Key Infrastructure (PKI) Design Guide&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://social.technet.microsoft.com/wiki/contents/articles/2901.public-key-infrastructure-design-guidance.aspx&quot;&gt;Public Key Infrastructure Design Guidance&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://techcommunity.microsoft.com/t5/ask-the-directory-services-team/designing-and-implementing-a-pki-part-i-design-and-planning/ba-p/396953&quot;&gt;Designing and Implementing a PKI: Part I Design and Planning&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Valentin LÉPINE</name></author><category term="Active Directory" /><category term="PKI" /><category term="Public Key Infrastructure" /><category term="Authoritie" /><category term="Authorities" /><category term="Certificate Authoritie" /><category term="Certificate Authorities" /><category term="CA" /><category term="Certificate" /><category term="Certificate Services" /><category term="AD CS" /><category term="Active Directory Certificate Services" /><category term="AD" /><category term="Active Directory" /><category term="Windows" /><category term="Windows Server" /><category term="Microsoft" /><category term="Security" /><category term="Services" /><category term="Server" /><summary type="html">The Active Directory Certificate Service (AD CS) provides functionality for managing a Public Key Infrastructure (PKI) that manages identities and other security features on the Windows domain. It can create, validate, and revoke public key certificates for an organization's internal uses.</summary></entry><entry><title type="html">How to configure Boundary Groups in System Center Configuration Manager</title><link href="http://localhost:4000/sccm/sccm-configure-boundary-groups/" rel="alternate" type="text/html" title="How to configure Boundary Groups in System Center Configuration Manager" /><published>2020-11-24T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/sccm/sccm-configure-boundary-groups</id><content type="html" xml:base="http://localhost:4000/sccm/sccm-configure-boundary-groups/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/logo-sccm-222x150.png&quot; class=&quot;align-left&quot; /&gt;&lt;strong&gt;Boundary groups&lt;/strong&gt; allow the logical organization of network locations. This allows clients to be directed to the nearest available SCCM server on the network. &lt;strong&gt;Boundary groups&lt;/strong&gt; also increase availability by redirecting clients to another server in case of failure of the nearest server.&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Clients use a &lt;strong&gt;boundary groups&lt;/strong&gt; for :
&lt;ul&gt;
  &lt;li&gt;Automatic &lt;strong&gt;site assignment&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;To find a &lt;strong&gt;site system server&lt;/strong&gt; that can provide a service, including:&lt;/li&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Distribution points&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Software update points&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;State migration points&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Management points&lt;/strong&gt;&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Cloud management gateway&lt;/strong&gt;&lt;/li&gt;
    &lt;/ul&gt;
&lt;/ul&gt;
&lt;/p&gt;

&lt;h2 id=&quot;before-starting&quot;&gt;Before starting&lt;/h2&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;You can read the following articles :&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;/active%20directory/install-active-directory/&quot;&gt;How to install a domain controller Active Directory on Windows Server&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sql/install-sql-server-2016/&quot;&gt;How to installer Microsoft SQL Server 2016&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sccm/sccm-install-prerequisites/&quot;&gt;How to install the prerequisites for System Center Configuration Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sccm/sccm-install/&quot;&gt;How to install System Center Configuration Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sccm/sccm-configure-discovery-methods/&quot;&gt;How to configure Discovery Methods in System Center Configuration Manager&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;concept&quot;&gt;Concept&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The following diagram shows an example of use.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/diagram-boundary-groups.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Datacenter :&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Boundarie - Datacenter :&lt;/strong&gt; a boundarie is based on the Active Directory Datacenter site.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Boundary Group - Datacenter :&lt;/strong&gt; a boundary group containing the boundarie datacenter, and referral for members, the primary site code S01 and site system server of the datacenter.&lt;/li&gt;
    &lt;/ul&gt; 
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Paris :&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Boundarie - Paris :&lt;/strong&gt; a boundarie is based on the Active Directory Datacenter site.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Boundary Group - Paris :&lt;/strong&gt; a boundary group containing the boundarie cited, and reference for the members, the secondary site code S02 and system server site of Paris and in failback that of the Datacenter.&lt;/li&gt;
    &lt;/ul&gt; 
  &lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;VPN :&lt;/strong&gt;
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;Boundarie - VPN 1 :&lt;/strong&gt; a boundarie based on a range of IP addresses of the VPN stations.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Boundarie - VPN 2 :&lt;/strong&gt; a boundarie based on a range of IP addresses of the VPN stations.&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;Boundary Group - VPN :&lt;/strong&gt; a boundary group containing the cited boundary, and reference for members, the primary site code S01 and site system server of the Datacenter.&lt;/li&gt;
    &lt;/ul&gt; 
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;configuration&quot;&gt;Configuration&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The boundarie and boundary groups will be created following the example below.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/diagram-boundary-groups-labvl.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Configuration Manager Console&quot;&lt;/strong&gt;, in the bottom left panel, select &lt;strong&gt;&quot;Administration&quot;&lt;/strong&gt;. Scroll down the &lt;strong&gt;&quot;Hierachy Configuration&quot;&lt;/strong&gt; folder and select &lt;strong&gt;&quot;Boundaries&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_06-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;If you followed the article &lt;a href=&quot;/sccm/SCCM-configure-discovery-methods/&quot;&gt;How to configure Discovery Methods in SCCM&lt;/a&gt; and activate the &lt;strong&gt;&quot;Active Directory Forest Discovery&quot;&lt;/strong&gt;, the &lt;strong&gt;Paris&lt;/strong&gt; boundaries must have been created automatically.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_07-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In left panel, scroll down the &lt;strong&gt;&quot;Hierachy Configuration&quot;&lt;/strong&gt; folder and select &lt;strong&gt;&quot;Boundary Groups&quot;&lt;/strong&gt;. By default the boundary group &lt;strong&gt;&quot;Default-Site-Boundary-Group&amp;lt;COR&amp;gt;&quot;&lt;/strong&gt; is the boundary group to which clients connect if no others are available.&lt;br /&gt; In the ribbon click on &lt;strong&gt;&quot;Create Bondary&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_08-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the field &lt;strong&gt;&quot;Name:&quot;&lt;/strong&gt; give a name to your boundary group, for me &lt;strong&gt;&quot;SA - Paris&quot;&lt;/strong&gt;, in the field &lt;strong&gt;&quot;Descripstion:&quot;&lt;/strong&gt; give a description &lt;strong&gt;&quot;Boundary group Paris&quot;&lt;/strong&gt;. Then click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_09-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select the boundarie &lt;strong&gt;&quot;Paris&quot;&lt;/strong&gt; and click &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_10-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select the &lt;strong&gt;&quot;References&quot;&lt;/strong&gt; tab, in the section &lt;strong&gt;&quot;Site assignement&quot;&lt;/strong&gt; check the &lt;strong&gt;&quot;Use this boundary group for site assignement&quot;&lt;/strong&gt; box, in the &lt;strong&gt;&quot;Assigned site:&quot;&lt;/strong&gt; select your site, for me &lt;strong&gt;&quot;COR-Corporate Site&quot;&lt;/strong&gt;. And click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_11-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check the box of your site system to assign &lt;strong&gt;&quot;\\CORPWSCM1.corp.priv&quot;&lt;/strong&gt; and clik on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_12-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Clik on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_13-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Your boundary group is now created.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-24-sccm-configure-boundary-groups/2020-11-24-17_47_14-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;There you go ! Your clients who are located in the Active Directory site &lt;strong&gt;&quot;Paris&quot;&lt;/strong&gt; will be assigned the site code &lt;strong&gt;&quot;COR&quot;&lt;/strong&gt; and will connect to the site system server &lt;strong&gt;&quot;CORPWSCM1&quot;&lt;/strong&gt;.&lt;/p&gt;</content><author><name>Valentin LÉPINE</name></author><category term="SCCM" /><category term="SCCM" /><category term="System Center" /><category term="Configuration Manager" /><category term="System Center Configuration Manager" /><category term="Windows" /><category term="Windows Server" /><category term="Microsoft" /><category term="Boundaries" /><category term="Boundary Group" /><category term="Boundary Groups" /><category term="Site system" /><category term="Site system server" /><category term="Site assignment" /><category term="Site" /><category term="Site Active Directory" /><category term="Distribution Points" /><category term="Software Update Points" /><category term="State Migration Points" /><category term="Management Points" /><category term="Cloud Management Gateway" /><category term="IP" /><category term="Internet Protocol" /><category term="IPv4" /><category term="Active Directory Forest Discovery" /><category term="Active Directory Forest" /><summary type="html">Boundary groups allow the logical organization of network locations. This allows clients to be directed to the nearest available SCCM server on the network. Boundary groups also increase availability by redirecting clients to another server in case of failure of the nearest server.</summary></entry><entry><title type="html">How to configure Discovery Methods in System Center Configuration Manager</title><link href="http://localhost:4000/sccm/sccm-configure-discovery-methods/" rel="alternate" type="text/html" title="How to configure Discovery Methods in System Center Configuration Manager" /><published>2020-11-22T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/sccm/sccm-configure-discovery-methods</id><content type="html" xml:base="http://localhost:4000/sccm/sccm-configure-discovery-methods/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/logo-sccm-222x150.png&quot; class=&quot;align-left&quot; /&gt;Configuration manager's discovery methods allow several Active Directory objects or network resources to be imported into SCCM automatically. In the following article, I will detail the following methods of discovery : Active Directory Forest Discovery, Active Directory Group Discovery, Active Directory System Discovery, Active Directory Users Discovery.&lt;/p&gt;

&lt;h2 id=&quot;before-starting&quot;&gt;Before starting&lt;/h2&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;You can read the following articles :&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;/active%20directory/install-active-directory/&quot;&gt;How to install a domain controller Active Directory on Windows Server&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sql/install-sql-server-2016/&quot;&gt;How to installer Microsoft SQL Server 2016&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sccm/sccm-install-prerequisites/&quot;&gt;How to install the prerequisites for System Center Configuration Manager&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sccm/sccm-install/&quot;&gt;How to install System Center Configuration Manager&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;discovery-methods&quot;&gt;Discovery Methods&lt;/h2&gt;

&lt;h3 id=&quot;active-directory-forest-discovery&quot;&gt;Active Directory Forest Discovery&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Configuration Manager Console&quot;&lt;/strong&gt;, in the bottom left panel, select &lt;strong&gt;&quot;Administration&quot;&lt;/strong&gt;. Scroll down the &lt;strong&gt;&quot;Hierachy Configuration&quot;&lt;/strong&gt; folder and select &lt;strong&gt;&quot;Discovery Methods&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_18-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On the right hand part, select &lt;strong&gt;&quot;Active Directory Forest Discovery&quot;&lt;/strong&gt; and in the ribbon, click on &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_19-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check the &lt;strong&gt;&quot;Enable Active Directory Forest Discovery&quot;&lt;/strong&gt; box, and the &lt;strong&gt;&quot;Automatically create Active Directory site boundaries when they are discovered&quot;&lt;/strong&gt; box.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_20-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Yes&quot;&lt;/strong&gt; to run the discovery immediately.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_21-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;active-directory-group-discovery&quot;&gt;Active Directory Group Discovery&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On the right hand part, select &lt;strong&gt;&quot;Active Directory Group Discovery&quot;&lt;/strong&gt; and in the ribbon, click on &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_22-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check the box &lt;strong&gt;&quot;Enable Active Directory Group Discovery&quot;&lt;/strong&gt;, at the bottom click on &lt;strong&gt;&quot;Add&quot;&lt;/strong&gt; then &lt;strong&gt;&quot;Location...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_23-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Name:&quot;&lt;/strong&gt; field enter the name of the location, for me &lt;strong&gt;&quot;Corp - Groups Users&quot;&lt;/strong&gt;, in the &lt;strong&gt;&quot;Location:&quot;&lt;/strong&gt; section. Click on &lt;strong&gt;&quot;Browse...&quot;&lt;/strong&gt; and select your OU, I would use for my part &lt;strong&gt;&quot;LDAP://OU=Groups,OU=Paris,OU=Site,OU=CORP,DC=corp,DC=priv&quot;&lt;/strong&gt;. &lt;br /&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_24-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_25-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Yes&quot;&lt;/strong&gt; to execute the discovery immediately.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_26-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;active-directory-system-discovery&quot;&gt;Active Directory System Discovery&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On the right hand part, select &lt;strong&gt;&quot;Active Directory System Discovery&quot;&lt;/strong&gt; and in the ribbon, click on &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_27-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check the box &lt;strong&gt;&quot;Enable Active Directory System Discovery&quot;&lt;/strong&gt;, click on the button with the &lt;strong&gt;&quot;sun symbol&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_28-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Path:&quot;&lt;/strong&gt; field, click on &lt;strong&gt;&quot;Browse...&quot;&lt;/strong&gt; and select your OU, I would use for my part &lt;strong&gt;&quot;LDAP://DC=corp,DC=priv&quot;&lt;/strong&gt;. &lt;br /&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_29-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_30-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Yes&quot;&lt;/strong&gt; to execute the discovery immediately.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_26-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;active-directory-users-discovery&quot;&gt;Active Directory Users Discovery&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On the right hand part, select &lt;strong&gt;&quot;Active Directory Users Discovery&quot;&lt;/strong&gt; and in the ribbon, click on &lt;strong&gt;&quot;Properties&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_31-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Check the box &lt;strong&gt;&quot;Enable Active Directory Users Discovery&quot;&lt;/strong&gt;, click on the button with the &lt;strong&gt;&quot;sun symbol&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_32-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Path:&quot;&lt;/strong&gt; field, click on &lt;strong&gt;&quot;Browse...&quot;&lt;/strong&gt; and select your OU, I would use for my part &lt;strong&gt;&quot;LDAP://DC=corp,DC=priv&quot;&lt;/strong&gt;. &lt;br /&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_33-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_34-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Yes&quot;&lt;/strong&gt; to execute the discovery immediately.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2020-11-22-sccm-configure-discovery-methods/2020-06-06-20_37_26-mRemoteNG---confCons.xml---CORPWSCM1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;There you go ! The discovery is now configured, you can now find all your Active Directory objects in SCCM.&lt;/p&gt;</content><author><name>Valentin LÉPINE</name></author><category term="SCCM" /><category term="SCCM" /><category term="System Center" /><category term="Configuration Manager" /><category term="System Center Configuration Manager" /><category term="Windows" /><category term="Windows Server" /><category term="Microsoft" /><category term="Active Directory" /><category term="LDAP" /><category term="Lightweight Directory Access Protocol" /><category term="Forest" /><category term="User" /><category term="Users" /><category term="Group" /><category term="Groups" /><category term="Discovery" /><category term="Discovery Methods" /><category term="OU" /><category term="Organizational Unit" /><category term="Bondaries" /><category term="Sites" /><category term="Sites Active Directory" /><category term="Active Directory Forest" /><category term="Active Directory Forest Discovery" /><category term="Active Directory Group" /><category term="Active Directory Group Discovery" /><category term="Active Directory System" /><category term="Active Directory System Discovery" /><category term="Active Directory Users" /><category term="Active Directory Users Discovery" /><summary type="html">Configuration manager's discovery methods allow several Active Directory objects or network resources to be imported into SCCM automatically. In the following article, I will detail the following methods of discovery : Active Directory Forest Discovery, Active Directory Group Discovery, Active Directory System Discovery, Active Directory Users Discovery.</summary></entry><entry><title type="html">Create a application with Powershell in System Center Configuration Manager</title><link href="http://localhost:4000/powershell/powershell-create-sccm-application/" rel="alternate" type="text/html" title="Create a application with Powershell in System Center Configuration Manager" /><published>2020-11-08T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/powershell/powershell-create-sccm-application</id><content type="html" xml:base="http://localhost:4000/powershell/powershell-create-sccm-application/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2020-11-08-powershell-create-sccm-application/logo-sccm-application-222x150.png&quot; class=&quot;align-left&quot; /&gt;When integrating applications into &lt;strong&gt;System Center Configuration Manager&lt;/strong&gt;, it can be complicated to create uniformly applications that all have different parameters and specificities.
The developed script allows to meet this need and to establish a silimar integration process for applications. Application packaging is developed with the &lt;a href=&quot;https://psappdeploytoolkit.com/&quot;&gt;PSAppDeployToolkit&lt;/a&gt; utility, which allows to standardize packages.&lt;/p&gt;

&lt;h2 id=&quot;working&quot;&gt;Working&lt;/h2&gt;
&lt;p&gt;La configuration des différents paramètres de l’application est contenu dans le fichier XML&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;The configuration :&lt;/strong&gt; the configuration of the various parameters of the application is contained in the XML file called &lt;strong&gt;ApplicationConf.xml&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;AppDetails&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Name&amp;gt;&lt;/span&gt;Accounting Application&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Version&amp;gt;&lt;/span&gt;1.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Comment&amp;gt;&lt;/span&gt;Application for accounting&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Comment&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;LocalizedName&amp;gt;&lt;/span&gt;Application&lt;span class=&quot;nt&quot;&gt;&amp;lt;/LocalizedName&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Publisher&amp;gt;&lt;/span&gt;Corporate&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Publisher&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;IconLocationFile&amp;gt;&lt;/span&gt;\\corpwscm1\SCCM_CORP\Applications\Application-v1.0\AppDeployToolkit\AppIcon.png&lt;span class=&quot;nt&quot;&gt;&amp;lt;/IconLocationFile&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;ContentLocation&amp;gt;&lt;/span&gt;\\corpwscm1\SCCM_CORP\Applications\Application-v1.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/ContentLocation&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstallCommand&amp;gt;&lt;/span&gt;Deploy-Application.exe -DeploymentType &quot;Install&quot; -DeployMode &quot;Silent&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstallCommand&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;UninstallCommand&amp;gt;&lt;/span&gt;Deploy-Application.exe -DeploymentType &quot;Uninstall&quot; -DeployMode &quot;Silent&quot;&lt;span class=&quot;nt&quot;&gt;&amp;lt;/UninstallCommand&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstallationBehaviorType&amp;gt;&lt;/span&gt;InstallForSystem&lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstallationBehaviorType&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;DetectScript&amp;gt;&lt;/span&gt;if (Test-Path `&quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\MyProdct`&quot;){ if ((Get-ItemProperty -Path `&quot;HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\MyProduct`&quot; -Name `&quot;DisplayVersion`&quot;).DisplayVersion -eq `&quot;$Version`&quot;) { Write-Host `&quot;Installed`&quot; } } exit 0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/DetectScript&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;Folder&amp;gt;&lt;/span&gt;New-App&lt;span class=&quot;nt&quot;&gt;&amp;lt;/Folder&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;InstallationProgramVisibility&amp;gt;&lt;/span&gt;Hidden&lt;span class=&quot;nt&quot;&gt;&amp;lt;/InstallationProgramVisibility&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;LogonRequirementType&amp;gt;&lt;/span&gt;WhetherOrNotUserLoggedOn&lt;span class=&quot;nt&quot;&gt;&amp;lt;/LogonRequirementType&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;DistributionPriority&amp;gt;&lt;/span&gt;High&lt;span class=&quot;nt&quot;&gt;&amp;lt;/DistributionPriority&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;DistributionPointName&amp;gt;&lt;/span&gt;CORPWSCM1.CORP.PRIV&lt;span class=&quot;nt&quot;&gt;&amp;lt;/DistributionPointName&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/AppDetails&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;The function :&lt;/strong&gt; The &lt;strong&gt;Add-Application&lt;/strong&gt; function in the file &lt;strong&gt;Add-Application.ps1&lt;/strong&gt; allows the creation of the following elements :&lt;/p&gt;
&lt;ul&gt;
    &lt;li&gt;Creation of the application&lt;/li&gt;
    &lt;li&gt;Modification of the application&lt;/li&gt;
    &lt;li&gt;Creating the deployment type&lt;/li&gt;
    &lt;li&gt;Distribution of the application on the distribution point&lt;/li&gt;
    &lt;li&gt;Move the application to a specific folder&lt;/li&gt;
    &lt;li&gt;Creating an Active Directory group&lt;/li&gt;
    &lt;li&gt;Creating a user collection targeted to the Active Directory group&lt;/li&gt;
    &lt;li&gt;Move the user collection to a specific folder&lt;/li&gt;
    &lt;li&gt;Creating an application deployment on the user collection&lt;/li&gt;
    &lt;li&gt;Creating a peripheral collection&lt;/li&gt;
    &lt;li&gt;Move the peripheral collection to a specific folder&lt;/li&gt;
    &lt;li&gt;Creating an application deployment on the peripheral collection&lt;/li&gt;
&lt;/ul&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To call the function, just specify with the argument &lt;strong&gt;-XMLFile&lt;/strong&gt; the location of the XML file.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Add-Application&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-XMLFile&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;C:\ApplicationConf.xml&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;add-application-function&quot;&gt;Add-Application function&lt;/h2&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;Function&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add-Application&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;&amp;lt;#
&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.SYNOPSIS&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    The Add-Application function allows the creation of an application in SCCM and the associated structure from an XML file.

&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.DESCRIPTION&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    The Add-Application function allows the creation of the following elements :
    - Creation of the application
    - Modification of the application
    - Creating the deployment type
    - Distribution of the application on the distribution point
    - Move the application to a specific folder
    - Creating an Active Directory group
    - Creating a user collection targeted to the Active Directory group
    - Move the user collection to a specific folder
    - Creating an application deployment on the user collection
    - Creating a peripheral collection
    - Move the peripheral collection to a specific folder
    - Creating an application deployment on the peripheral collection

&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.PARAMETER&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt; XMLfile
    Mandatory parameter. This is the path of the XML file with the application settings.

&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.EXAMPLE&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    PS C:\&amp;gt; Add-Application -XMLFile &quot;C:\ApplicationConf.xml&quot;

&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.NOTES&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    Author  : Valentin LÉPINE
    Email   : vlepineadm@outlook.com
    Date    : 08/11/2020
    Twitter : @vlepineadm
    Github  : https://github.com/vlepineadm/Add-Application
    Website : https://blog.labvl.net/
    Version : 1.0

    Microsoft Documentation :
    - https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c?redirectedfrom=MSDN
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMApplication
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Set-CMApplication
    - https://docs.microsoft.com/en-us/powershell/module/configurationmanager/add-cmscriptdeploymenttype
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Start-CMContentDistribution
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMApplication
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Move-CMObject
    - https://docs.microsoft.com/en-us/powershell/module/addsadministration/Get-ADGroup
    - https://docs.microsoft.com/en-us/powershell/module/addsadministration/new-adgroup
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMUserCollection
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMUserCollection
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Add-CMUserCollectionQueryMembershipRule
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMApplicationDeployment
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMApplicationDeployment
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMDeviceCollection
    - https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMDeviceCollection
#&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CmdletBinding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;OutputType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;System.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;PARAM&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Parameter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Mandatory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)][&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;System.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$XMLfile&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# -------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Definition of global variables --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# -------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# SCCM Variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ExeLocation&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-Location&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteServer&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;CORPWSCM1&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteCode&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;COR&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteDrive&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteCode&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;:&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Domain variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DomainName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;CORP&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Application variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DefaultLanguageId&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1033&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# en-US&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixAppName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;APP-&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixAppDeployType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;APP-DT-&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Group variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixAppGrp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;GRP_SCCM_APP_&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PathAppGrp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;OU=SCCM,OU=Groups,DC=corp,DC=priv&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# User collection variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixColUser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;COL-USR-APP-&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FolderColUser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# &quot;\PROD-Application&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Device collection variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixColDevice&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;COL-DEV-APP-&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FolderColDevice&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# &quot;\PRO-Application&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Import of modules --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Import of the SCCM module #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Import of the SCCM module.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Import-Module&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;nn&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SMS_ADMIN_UI_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;\bin\i386&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;\bin\configurationmanager.psd1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Module import error : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Import of the Active Directory module #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Import of the Active Directory module.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Import-Module&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ActiveDirectory&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Module import error : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Move to the SCCM site #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-PSDrive&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteCode&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;SilentlyContinue&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Measure-Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Count&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-ne&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-PSDrive&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteCode&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-PSProvider&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;AdminUI.PS.Provider\CMSite&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Root&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteServer&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Set-Location&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteDrive&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-content&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$XMLfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Retrieving the file : &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$XMLfile&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Import of the XML file into the $ App variable #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Select-Xml&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$XMLfile&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-XPath&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/AppDetails&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Select-Object&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ExpandProperty&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Processing of variables --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Application variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixAppName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-v&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppDeployType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixAppDeployType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-v&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FolderApp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;\&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Folder&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Group variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppDesc&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;-&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixAppGrp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpDisName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpDes&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SCCM group for the application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppDesc&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Collection variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixColUser&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Collection name user&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserComment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;User collection for the application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppDesc&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; linked to the group &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# User collection comment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SuffixColDevice&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Device collection name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceComment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Device collection for the application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppDesc&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Device collection comment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ----------------------------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --------------- Creation of the application --------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ----------------------------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Checking the presence of the application #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMApplication&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Creation of the application #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Creation of the application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-CMApplication&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Publisher&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Publisher&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-SoftwareVersion&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-AutoInstall&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$True&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DefaultLanguageId&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DefaultLanguageId&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-LocalizedName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-IconLocationFile&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;IconLocationFile&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-IsFeatured&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$false&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error creating the application : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Modification of the application #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Modification of the application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Set-CMApplication&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DistributionPriority&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DistributionPriority&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Application modification error : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  

            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Creating the deployment type #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Creating the deployment type &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppDeployType&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add-CMScriptDeploymentType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ApplicationName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DeploymentTypeName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppDeployType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ContentLocation&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ContentLocation&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-InstallCommand&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;InstallCommand&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-UninstallCommand&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;UninstallCommand&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-InstallationBehaviorType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;InstallationBehaviorType&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ScriptLanguage&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;PowerShell&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ScriptText&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DetectScript&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-InstallationProgramVisibility&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;InstallationProgramVisibility&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-LogonRequirementType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;LogonRequirementType&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-SlowNetworkDeploymentMode&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Download&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                 &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Application deployment type error : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  

            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Distribution of the application on the DP #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Distribution of the application on the DP.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Start-CMContentDistribution&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ApplicationName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DistributionPointName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$App&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;DistributionPointName&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Application distribution error : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  

            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Moving the application #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Moving the application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppObj&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMApplication&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Move-CMObject&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-InputObject&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$AppObj&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-FolderPath&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;':\Application'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FolderApp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error moving application : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; application already exists.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ------------------------------------------------------------------ #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --------------- Creation of the group &amp;amp; collections -------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ------------------------------------------------------------------ #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# -------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Creation of the AD group --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# -------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# If the group exists #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-ADGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Group creation &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-ADGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpDisName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Description&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpDes&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$PathAppGrp&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-GroupCategory&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Security&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-GroupScope&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;DomainLocal&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;             
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;   
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Creation of the user collection --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
 
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMUserCollection&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Creation of the user Collection #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Creation of the collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColTab&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;@{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Query&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;select SMS_R_USER.ResourceID,SMS_R_USER.ResourceType,SMS_R_USER.Name,SMS_R_USER.UniqueUserName,SMS_R_USER.WindowsNTDomain from SMS_R_User where SMS_R_User.UserGroupName = '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DomainName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GrpName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;'&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-CMUserCollection&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-LimitingCollectionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;All Users and User Groups&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Comment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserComment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-RefreshType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Continuous&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Add-CMUserCollectionQueryMembershipRule&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CollectionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColTab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-QueryExpression&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColTab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Query&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-RuleName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColTab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error creating collection : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Move the user collection #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Moving the collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColObj&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMUserCollection&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Move-CMObject&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-InputObject&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColObj&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-FolderPath&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;':\UserCollection'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FolderColUser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error moving collection : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;   
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; collection already exists.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;            


        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --------------------------------------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Creation of the application deployment on the user collection --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --------------------------------------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserDeploymentExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMApplicationDeployment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CollectionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserDeploymentExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Creation of the user deployment #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Creation of the user deployment of the  &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; application on the collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-CMApplicationDeployment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CollectionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DeployAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DeployPurpose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Available&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-UserNotification&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;DisplaySoftwareCenterOnly&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error creating deployment : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;   
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Deployment of application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; on collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColUserName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ----------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Creation of the device collection --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# ----------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMDeviceCollection&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;     
            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Creation of the device collection #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Creation of the collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-CMDeviceCollection&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-LimitingCollectionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;All Systems&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Comment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceComment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-RefreshType&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Continuous&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error creating collection : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Move device collection #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Move device collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColObj&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMDeviceCollection&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Move-CMObject&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-InputObject&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColObj&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-FolderPath&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SiteCode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;':\DeviceCollection'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$FolderColDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error moving collection : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;   
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; collection already exists.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# -------------------------------------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# --- Creating the application deployment on the device collection --- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# -------------------------------------------------------------------- #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceDeploymentExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-CMApplicationDeployment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CollectionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceDeploymentExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Creating the device deployment #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Green&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Creation of the computer deployment of the &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; application on the collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-CMApplicationDeployment&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CollectionName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DeployAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Install&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DeployPurpose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Required&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-UserNotification&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;DisplaySoftwareCenterOnly&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                    &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ErrorAction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Stop&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Out-Null&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Error creating deployment : &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;exception&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;   
            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Deployment of application &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SCCMAppName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; on collection &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ColDeviceName&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ForegroundColor&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Red&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$XMLfile&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; file could not be found.&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Replacement in the original directory #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Set-Location&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ExeLocation&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## End of the Add-Application function ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;download&quot;&gt;Download&lt;/h2&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;The code is available on &lt;a href=&quot;https://github.com/vlepineadm/Add-Application&quot;&gt;Github&lt;/a&gt; repository.&lt;/p&gt;

&lt;h2 id=&quot;ressources&quot;&gt;Ressources&lt;/h2&gt;

&lt;ul&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c?redirectedfrom=MSDN&quot;&gt;Langauage ID&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMApplication&quot;&gt;New-CMApplication&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Set-CMApplication&quot;&gt;Set-CMApplication&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/configurationmanager/add-cmscriptdeploymenttype&quot;&gt;Add-CMScriptDeploymentType&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Start-CMContentDistribution&quot;&gt;Start-CMContentDistribution&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMApplication&quot;&gt;Get-CMApplication&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Move-CMObject&quot;&gt;Move-CMObject&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/addsadministration/Get-ADGroup&quot;&gt;Get-ADGroup&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/addsadministration/new-adgroup&quot;&gt;New-ADGroup&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMUserCollection&quot;&gt;Get-CMUserCollection&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMUserCollection&quot;&gt;New-CMUserCollection&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Add-CMUserCollectionQueryMembershipRule&quot;&gt;Add-CMUserCollectionQueryMembershipRule&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMApplicationDeployment&quot;&gt;Get-CMApplicationDeployment&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMApplicationDeployment&quot;&gt;New-CMApplicationDeployment&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/Get-CMDeviceCollection&quot;&gt;Get-CMDeviceCollection&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/powershell/module/ConfigurationManager/New-CMDeviceCollection&quot;&gt;New-CMDeviceCollection&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Valentin LÉPINE</name></author><category term="Powershell" /><category term="Windows" /><category term="Microsoft" /><category term="Powershell" /><category term="PS" /><category term="SCCM" /><category term="System Center" /><category term="Configuration Manager" /><category term="System Center Configuration Manager" /><category term="Application" /><category term="Github" /><category term="Repository" /><category term="Repo" /><category term="PSAppDeployToolkit" /><category term="XML" /><category term="Extensible Markup Language" /><category term="Deployment Type" /><category term="DP" /><category term="Distribution Point" /><category term="AD" /><category term="Active Directory" /><category term="Group" /><category term="User" /><category term="Collection" /><category term="Device" /><category term="Device Collection" /><category term="User Collection" /><category term="Function" /><category term="Module" /><category term="Package" /><summary type="html">When integrating applications into System Center Configuration Manager, it can be complicated to create uniformly applications that all have different parameters and specificities. The developed script allows to meet this need and to establish a silimar integration process for applications. Application packaging is developed with the PSAppDeployToolkit utility, which allows to standardize packages.</summary></entry><entry><title type="html">How to install System Center Configuration Manager</title><link href="http://localhost:4000/sccm/sccm-install/" rel="alternate" type="text/html" title="How to install System Center Configuration Manager" /><published>2019-06-15T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/sccm/sccm-install</id><content type="html" xml:base="http://localhost:4000/sccm/sccm-install/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/logo-sccm-222x150.png&quot; class=&quot;align-left&quot; /&gt;&lt;strong&gt;System Center Configuration Manager (SCCM)&lt;/strong&gt; is a system management software published by Microsoft. It is intended for the management of large computer parks. It allows: remote control, management and deployment of updates and patches, automation of tasks, remote distribution of applications, hardware and software inventory, compliance management, administration of security policies, deployment of operating systems.&lt;/p&gt;

&lt;h2 id=&quot;before-starting&quot;&gt;Before starting&lt;/h2&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;You can read the following articles :&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;/active%20directory/install-active-directory/&quot;&gt;How to install a domain controller Active Directory on Windows Server&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sql/install-sql-server-2016/&quot;&gt;How to installer Microsoft SQL Server 2016&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sccm/sccm-install-prerequisites/&quot;&gt;How to install the prerequisites for System Center Configuration Manager&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;install-system-center-configuration-manager&quot;&gt;Install System Center Configuration Manager&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Go to &lt;strong&gt;&quot;Z:\&quot;&lt;/strong&gt; on your SCCM installation CD, and run &lt;strong&gt;&quot;splash.exe&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-16_54_15-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The Microsoft System Center Configuration Manager installation wizard starts.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-16_55_56-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Install&quot;&lt;/strong&gt; to begin.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-16_57_01-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Before You Begin :&lt;/strong&gt; the wizard lists the prerequisites for installation. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-16_59_45-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Getting Started :&lt;/strong&gt; select &lt;strong&gt;&quot;Install a Configuration Manager primary site&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_00_10-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Product Key :&lt;/strong&gt; select &lt;strong&gt;&quot;Install the licensed edition of this product&quot;&lt;/strong&gt;, enter your product key in the field and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_01_27-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Product License Terms :&lt;/strong&gt; check the following boxes :
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&quot;I accept these License Terms and Privacy Statement.&quot;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&quot;I accept these License Terms.&quot;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&quot;I accept these License Terms.&quot;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
And click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_02_19-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Prerequisite Downloads :&lt;/strong&gt; select &lt;strong&gt;&quot;Download required files&quot;&lt;/strong&gt;, enter the following path : &lt;strong&gt;&quot;C:\Users\administrator.CORP\Downloads&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_02_46-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The wizard downloads the files required for the installation.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_03_08-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Server Language Selection :&lt;/strong&gt; select the languages you want to add for the configuration manager and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_10_30-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Server Language Selection :&lt;/strong&gt;  select the languages you want to add for the client part, for my part I would choose &lt;strong&gt;&quot;French&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_11_38-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Site and Installation Settings :&lt;/strong&gt; fill in the &lt;strong&gt;&quot;Site code:&quot;&lt;/strong&gt; with a 3 letter word, I would choose &lt;strong&gt;CORP&lt;/strong&gt;.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Fill in the &lt;strong&gt;&quot;Site name:&quot;&lt;/strong&gt; with the name of your site.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;In the field &lt;strong&gt;&quot;Installation folder:&quot;&lt;/strong&gt; indicate the following path : &lt;strong&gt;&quot;D:\Program Files\Microsoft Configuration Manager&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Check the box &lt;strong&gt;&quot;Install the Configuration Manager console&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_13_59-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Primary Site Installation :&lt;/strong&gt; select &lt;strong&gt;&quot;Install the primary site as a stand-alone site&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_14_30-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Yes&quot;&lt;/strong&gt; to accept.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_14_56-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Database Information :&lt;/strong&gt; enter the name of your SQL server in the field &lt;strong&gt;&quot;SQL Server name (FQDN):&quot;&lt;/strong&gt; for my part  &lt;strong&gt;corpwsql1.corp.priv&lt;/strong&gt;.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Enter the name of your future database in the field &lt;strong&gt;&quot;Database name:&quot;&lt;/strong&gt; for me &lt;strong&gt;CM_COR&lt;/strong&gt;. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_16_06-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Database Information :&lt;/strong&gt; Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_16_33-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;SMS Provider Setting :&lt;/strong&gt; in the field &lt;strong&gt;&quot;SMS Provider (FQDN):&quot;&lt;/strong&gt; check that the full name of your SCCM server appears : SCCM : &lt;strong&gt;corpwscm1.corp.priv&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_16_56-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Client Computer Communication Settings :&lt;/strong&gt; check the option &lt;strong&gt;&quot;Configure the communication method on each site system role&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_17_22-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Site System Roles :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_17_42-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Diagnostic and Usage Data :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_18_14-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Service Connection Point Setup :&lt;/strong&gt; click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_18_53-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Prerequisite Check :&lt;/strong&gt; the wizard displays three warnings :
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;WSUS on site server :&lt;/strong&gt; there is no WSUS server currently installed on the site.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SQL Server Native Client version :&lt;/strong&gt; the current version needs to be updated.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;SQL Server process memory allocation :&lt;/strong&gt; the minimum memory reserve on the SQL server must be at least 8 GB.&lt;/li&gt;
&lt;/ul&gt;
Its various alerts are not blocking for the rest of the installation. You will find here the page listing &lt;a href=&quot;https://docs.microsoft.com/en-us/mem/configmgr/core/servers/deploy/install/list-of-prerequisite-checks&quot;&gt;the prerequisite checks for Configuration Manager&lt;/a&gt;.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Begin Install&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-17_30_10-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Install :&lt;/strong&gt; click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-18_31_53-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The configuration manager console is now available.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-15-sccm-install/2019-06-16-18_33_05-mRemoteNG---confCons.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;There you go ! Your infrastructure is now ready for you to start using SCCM.&lt;/p&gt;</content><author><name>Valentin LÉPINE</name></author><category term="SCCM" /><category term="Windows Server" /><category term="Microsoft" /><category term="Services" /><category term="Server" /><category term="SCCM" /><category term="System Center" /><category term="Configuration Manager" /><category term="System Center Configuration Manager" /><category term="Site" /><category term="Site Name" /><category term="Primary Site" /><category term="Language" /><category term="Stand-alone" /><category term="FQDN" /><category term="Fully qualified domain name" /><category term="Database" /><category term="SMS" /><category term="Systems Management Server" /><category term="Site System Roles" /><category term="Connection Point" /><category term="SQL Server" /><summary type="html">System Center Configuration Manager (SCCM) is a system management software published by Microsoft. It is intended for the management of large computer parks. It allows: remote control, management and deployment of updates and patches, automation of tasks, remote distribution of applications, hardware and software inventory, compliance management, administration of security policies, deployment of operating systems.</summary></entry><entry><title type="html">How to install the prerequisites for System Center Configuration Manager</title><link href="http://localhost:4000/sccm/sccm-install-prerequisites/" rel="alternate" type="text/html" title="How to install the prerequisites for System Center Configuration Manager" /><published>2019-06-05T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/sccm/sccm-install-prerequisites</id><content type="html" xml:base="http://localhost:4000/sccm/sccm-install-prerequisites/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/logo-sccm-222x150.png&quot; class=&quot;align-left&quot; /&gt;&lt;strong&gt;System Center Configuration Manager (SCCM)&lt;/strong&gt; is a system management software published by Microsoft. It is intended for the management of large computer parks. It allows: remote hand-taking, management and deployment of updates and patches, automation of tasks, cable applications, hardware and software inventory, compliance management, security policies, the deployment of operating systems.&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;For this tutorial, I would use a virtual machine with &lt;strong&gt;Windows Server 2016 Standard&lt;/strong&gt; integrated in the domain &lt;strong&gt;corp.priv&lt;/strong&gt; previously created with the following configuration :&lt;/p&gt;

&lt;h3 id=&quot;hardware&quot;&gt;Hardware&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Hardware&lt;/th&gt;
      &lt;th&gt;Specification&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;CPU :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;4 vCPU&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;RAM :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;4Go&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Disque dur :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;C:\System 50Go, D:\Data 60Go&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Réseau :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;Host-only&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;network&quot;&gt;Network&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Champs&lt;/th&gt;
      &lt;th&gt;Values&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;IP address :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;192.168.100.102&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Subnet :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;255.255.255.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Default gateway :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;192.168.100.254&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;DNS :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;192.168.100.100 (Active Directory server)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;preparation-of-the-server&quot;&gt;Preparation of the server&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Server Manager&quot;&lt;/strong&gt;, the program starts at startup.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Local Server&quot;&lt;/strong&gt; fill in the following parameters.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-22-23_20_21-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Computer name :&lt;/strong&gt; give a meaningful name to your server, for my part, I would take for example: &lt;strong&gt;CORPWSCM1&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Windows Firewall :&lt;/strong&gt; disable Windows Firewall.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Remote Desktop :&lt;/strong&gt; enable Remote Desktop.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ethernet0 :&lt;/strong&gt; set a fixed IP address, I'll take as an example: &lt;strong&gt;192.168.100.102&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-22-23_25_21-1.png&quot; class=&quot;align-center&quot; /&gt;
&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;notice--warning&quot;&gt;It is recommended by Microsot to perform all updates before any role installation.&lt;/span&gt;&lt;/p&gt;

&lt;h2 id=&quot;before-you-start&quot;&gt;Before you start&lt;/h2&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Before starting to install the prerequies for SCCM it is necessary at first to have followed the three posts below :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;/active%20directory/install-active-directory/&quot;&gt;How to install a domain controller Active Directory on Windows Server&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/dhcp/install-dhcp-server/&quot;&gt;How to install a DHCP server on Windows Server 2016&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;/sql/install-sql-server-2016/&quot;&gt;How to installer Microsoft SQL Server 2016&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;preparing-the-active-directory&quot;&gt;Preparing the Active Directory&lt;/h2&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Connect you to your Active Directory server to perform the following actions.&lt;/p&gt;

&lt;h3 id=&quot;creating-a-service-account&quot;&gt;Creating a service account&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Create an account in the Active Directory, for my part I would call it &lt;strong&gt;&quot;svc_sccm_adm&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 17_53_43-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;create-the-system-management-container&quot;&gt;Create the System Management container&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Server Manager&quot;&lt;/strong&gt; at the top right &lt;strong&gt;&quot;click&quot;&lt;/strong&gt; on &lt;strong&gt;&quot;Tools&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;ADSI Edit&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 17_54_33-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;ADSI Edit&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Connect to...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 17_55_12-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Leave the fields by default and click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 17_55_35-mRemoteNG - confCons.xml - CORPWADS1P.png.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Default naming context&quot;&lt;/strong&gt;, click on &lt;strong&gt;&quot;CN-System&quot;&lt;/strong&gt; and choose &lt;strong&gt;&quot;New&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Object...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 17_56_16-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Value:&quot;&lt;/strong&gt; field write &lt;strong&gt;&quot;System Management&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 17_58_18-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To finish the creation click on &lt;strong&gt;&quot;Finish&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 17_58_42-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;added-rights-to-the-system-management-container&quot;&gt;Added rights to the System Management container&lt;/h3&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Server Manager&quot;&lt;/strong&gt; at the top right &lt;strong&gt;&quot;click&quot;&lt;/strong&gt; on &lt;strong&gt;&quot;Tools&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Active Directory Users and Computers&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_00_37-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Top left click on &lt;strong&gt;&quot;View&quot;&lt;/strong&gt; and activates the &lt;strong&gt;&quot;Advanced Features&quot;&lt;/strong&gt; option.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_00_59-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To add a delegation click on &lt;strong&gt;&quot;System Management&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Delegate Control...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_07_24-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The assistant opens, click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_07_39-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_07_55-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the window click &lt;strong&gt;&quot;Object Types&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Computers&quot;&lt;/strong&gt; to be able to add your SCCM server.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_07_56-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Add your SCCM server, for me &lt;strong&gt;CORPWSCM1&lt;/strong&gt; and add the previously created &lt;strong&gt;svc_sccm_adm&lt;/strong&gt; account.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_08_37-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;&quot;Create a custom task to delegate&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_09_01-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select &lt;strong&gt;This folder, existing objects in this folder, and creation of new objects in this folder&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_09_21-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the section &lt;strong&gt;&quot;Show these permissions:&quot;&lt;/strong&gt; select the following options:
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&quot;General&quot;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&quot;Property-specific&quot;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&quot;Creation/deletion of specific chold objects&quot;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
In the section &lt;strong&gt;&quot;Permissions:&quot;&lt;/strong&gt; select the &lt;strong&gt;&quot;Full Control&quot;&lt;/strong&gt; options. And click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;. 
&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_09_49-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Pour finir l'assistant affiche le récapitulatif des actions. Click on &lt;strong&gt;&quot;Finish&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_10_11-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;changing-the-active-directory-schema&quot;&gt;Changing the Active Directory schema&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Connect you to your SCCM server to perform the following actions.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;See you in following &lt;strong&gt;&quot;Z:\SMSSETUP\BIN\X64\&quot;&lt;/strong&gt; on your SCCM installation CD, and execute &lt;strong&gt;&quot;extadsch.exe&quot;&lt;/strong&gt; with &lt;strong&gt;&quot;Run as administrator&quot;&lt;/strong&gt; option.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_13_27-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;When the operation is finished, an &lt;strong&gt;&quot;ExtADsch.log&quot;&lt;/strong&gt; file is generated.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_14_08-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Here is the contents of the log file. We can see that the operation is correct unrolled thanks to the line &lt;strong&gt;&quot;Successfully extend the Active Directory schema.&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_14_30-mRemoteNG - confCons.xml - CORPWADS1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;preparing-the-sccm-server&quot;&gt;Preparing the SCCM server&lt;/h2&gt;

&lt;h3 id=&quot;installing-roles-and-features&quot;&gt;Installing roles and features&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To install &lt;strong&gt;Background Intelligent Transfer Service (BITS)&lt;/strong&gt; and &lt;strong&gt;Remote Differential Compression (RDC)&lt;/strong&gt; perform the next command :&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;Install-WindowsFeature&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;BITS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;RDC&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Here's the result :&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_40_08-mRemoteNG - confCons.xml - CORPWSCM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To install &lt;strong&gt;.NET Framework 3.5&lt;/strong&gt; and &lt;strong&gt;.NET Framework 4.5&lt;/strong&gt; perform the next command :&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;Install-WindowsFeature&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;NET-Framework-Features&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;NET-Framework-45-Features&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Here's the result :&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_41_24-mRemoteNG - confCons.xml - CORPWSCM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To install &lt;strong&gt;IIS web server&lt;/strong&gt; with the necessary components perform the next command :&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;Install-WindowsFeature&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Server&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Common-Http&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Static-Content&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Http-Errors&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Security&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Windows-Auth&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-App-Dev&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Asp-Net&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Asp-Net45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Net-Ext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Net-Ext45&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-ISAPI-Ext&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Mgmt-Compat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Lgcy-Mgmt-Console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Metabase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Wmi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Web-Scripting-Tools&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-IncludeManagementTools&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Here's the result :&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-02-28 18_42_10-mRemoteNG - confCons.xml - CORPWSCM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;installing-windows-adk-for-windows-10&quot;&gt;Installing Windows ADK for Windows 10&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In this part we'll see how to install &lt;strong&gt;Windows Assessment and Deployment Kit (Windows ADK)&lt;/strong&gt; for Windows 10.&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Download the Windows ADK for Windows 10, version 1903 : &lt;a href=&quot;https://go.microsoft.com/fwlink/?linkid=2086042&quot;&gt;https://go.microsoft.com/fwlink/?linkid=2086042&lt;/a&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Run &lt;strong&gt;&quot;adksetup.exe&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-22_58_57-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the &lt;strong&gt;&quot;Install Path:&quot;&lt;/strong&gt; field, select the following path : &lt;strong&gt;&quot;D:\Program Files (x86)\Windows Kits\10\&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-22_59_38-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select whether you want to send data anonymously to Microsoft or not, and click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_00_12-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Accept the license, and click on &lt;strong&gt;&quot;Accept&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_00_42-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select these features :
  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;&quot;Deployment Tools&quot;&lt;/strong&gt;&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;&quot;User State Migration Tool (USMT)&quot;&lt;/strong&gt;&lt;/li&gt;
  &lt;/ul&gt;
And click on &lt;strong&gt;&quot;Install&quot;&lt;/strong&gt;.
&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_02_16-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The installation progress.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_03_27-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The installation is finished, click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_03_55-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Download the Windows PE add-on for the ADK : &lt;a href=&quot;https://go.microsoft.com/fwlink/?linkid=2087112&quot;&gt;https://go.microsoft.com/fwlink/?linkid=2087112&lt;/a&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Run &lt;strong&gt;&quot;adkwinpesetup.exe&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_05_01-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Leave the default choice and click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_05_36-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select whether you want to send data anonymously to Microsoft or not, and click on &lt;strong&gt;&quot;Next&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_05_54-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Accept the license, and click on &lt;strong&gt;&quot;Accept&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_06_11-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Select these features : &lt;strong&gt;&quot;Windows Preinstallation Environnment (Windows PE)&quot;&lt;/strong&gt;, and click on &lt;strong&gt;&quot;Install&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_06_28-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The installation progress.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_20_03-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The installation is finished, click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-14-23_32_46-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;configure-the-sql-server-2016&quot;&gt;Configure the SQL Server 2016&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Computer Management&quot;&lt;/strong&gt; then open &lt;strong&gt;&quot;System Tools&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Local Users and Groups&quot;&lt;/strong&gt;, and &lt;strong&gt;&quot;Groups&quot;&lt;/strong&gt;. Click on &lt;strong&gt;&quot;Administrators&quot;&lt;/strong&gt; group and select &lt;strong&gt;&quot;Add to Group...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-16-17_25_04-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Add...&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-16-17_25_39-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the window click &lt;strong&gt;&quot;Object Types&quot;&lt;/strong&gt; and select &lt;strong&gt;&quot;Computers&quot;&lt;/strong&gt; to be able to add your SCCM server.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-16-17_26_05-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Add your SCCM server, for me &lt;strong&gt;CORPWSCM1&lt;/strong&gt;. And click on &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-16-17_26_48-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click &lt;strong&gt;&quot;OK&quot;&lt;/strong&gt; to finish&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-05-sccm-install-prerequisites/2019-06-16-17_27_21-mRemoteNG---confCons.xml---LABNPWADM1P.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;There you go ! Your infrastructure is now ready for the installation of SCCM.&lt;/p&gt;</content><author><name>Valentin LÉPINE</name></author><category term="SCCM" /><category term="AD" /><category term="Active Directory" /><category term="Windows" /><category term="Windows Server" /><category term="Microsoft" /><category term="Security" /><category term="Services" /><category term="Server" /><category term="SCCM" /><category term="System Center" /><category term="Configuration Manager" /><category term="System Center Configuration Manager" /><category term="ADSI" /><category term="Active Directory Service Interfaces" /><category term="Delegate Control" /><category term="Computer" /><category term="User" /><category term="Active Directory Schema" /><category term="BITS" /><category term="RDC" /><category term=".NET Framework 3.5" /><category term=".NET Framework 4.5" /><category term="Web Server" /><category term="ADK" /><category term="Assessment and Deployment Kit" /><category term="Windows Assessment and Deployment Kit" /><category term="USMT" /><category term="User State Migration Tool" /><category term="WinPE" /><category term="Windows Pre-installation Environment" /><category term="SQL Server" /><category term="Structured Query Language" /><summary type="html">System Center Configuration Manager (SCCM) is a system management software published by Microsoft. It is intended for the management of large computer parks. It allows: remote hand-taking, management and deployment of updates and patches, automation of tasks, cable applications, hardware and software inventory, compliance management, security policies, the deployment of operating systems.</summary></entry><entry><title type="html">Create a FakeCompany with Powershell</title><link href="http://localhost:4000/powershell/powershell-create-fakecompany/" rel="alternate" type="text/html" title="Create a FakeCompany with Powershell" /><published>2019-06-02T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/powershell/powershell-create-fakecompany</id><content type="html" xml:base="http://localhost:4000/powershell/powershell-create-fakecompany/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2019-06-02-powershell-create-fakecompany/logo-fakecompany-222x150.png&quot; class=&quot;align-left&quot; /&gt;
While fessing tests in my lab, I got tired of creating users User01 groups, etc ... So I decided to create a script Powershell to create a similar structure to that of a company, allowing me to automatically create OUs, users, groups, computers, from a CSV file.&lt;/p&gt;

&lt;h2 id=&quot;company-scheme&quot;&gt;Company scheme&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-06-02-powershell-create-fakecompany/FakeCompany_Schema.jpg&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;working&quot;&gt;Working&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;The data :&lt;/strong&gt; The data is stored in a CSV file called &lt;strong&gt;new_FakeCompany.csv&lt;/strong&gt;. Each field is named as follows : field01,field02...&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;The function :&lt;/strong&gt; The function for creating the structure is in the &lt;strong&gt;FakeCompany.ps1&lt;/strong&gt; file. This function is based on a switch based on the first field of the CSV file.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'field01'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'OU'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create OU ##; Break }&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Groups'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create Groups ##; Break }&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Users'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create Users ##; Break }&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Computers'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create Computers ##; Break }&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Default&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The file format is invalid&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To call the function, just specify with the argument &lt;strong&gt;-CSVFile&lt;/strong&gt; the location of the CSV file.&lt;/p&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;PS&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;FakeCompany&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CSVFile&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;C:\new_FakeCompany.csv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;fakecompany&quot;&gt;FakeCompany&lt;/h2&gt;

&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kr&quot;&gt;Function&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FakeCompany&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;&amp;lt;#
&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.SYNOPSIS&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    This function allows you to create Active Directory OU, Groups, Users, Computers from CSV file.
&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.DESCRIPTION&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    This function allows you to create Active Directory OU, Groups, Users, Computers from CSV file.
&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.PARAMETER&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt; FilePath
    Specify the path of a CSV file containing Active Directory OU, Groups, Users, Computers informations.
&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.EXAMPLE&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    PS C:\&amp;gt; FakeCompany -CSVFile C:\new_FakeCompany.csv
&lt;/span&gt;&lt;span class=&quot;cs&quot;&gt;.NOTES&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;
    Valentin LEPINE
    Email : vlepineadm@outlook.com
    Twitter : @vlepineadm
    Github : https://github.com/vlepineadm/FakeCompany
#&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CmdletBinding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;OutputType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;System.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;PARAM&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;System.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CSVFile&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Global variables ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Global Groups variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GroupCategory&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Security&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GroupScope&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Global&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Global Users variables #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LocalDomain&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;corp.priv&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ExternalDomain&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;corporate.com&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Password&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'P@ssW0rd!'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Global Computers variables ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Domain&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LocalDomain&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OperatingSystem&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Windows 10 Enterprise&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OperatingSystemVersion&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;10.0 (17763)&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Function ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Remove-StringLatinCharacters&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;PARAM&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Text.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]::&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ASCII.GetString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Text.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]::&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Cyrillic&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;GetBytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FormattingVar&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CmdletBinding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;OutputType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;System.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;PARAM&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;System.&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Remove-StringLatinCharacters&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ToLower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$String&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Active Directory module import&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;Try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Import-Module&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ActiveDirectory&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;Catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;FileNotFoundException&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Error&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The Active Directory module could not be loaded&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Test-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CSVFile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-eq&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Contents&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Import-Csv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CSVFile&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Launching the FakeCompanyOU function&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Contents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'field01'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                 &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create OU ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'OU'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Name ###&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## If the OU exist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADOUExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-ADOrganizationalUnit&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Filter&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-like&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-SearchBase&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;DC=corp,DC=priv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADOUExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The OU &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-ADOrganizationalUnit&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-PassThru&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ProtectedFromAccidentalDeletion&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$false&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The OU &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; was created&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;Break&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## End create OU ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create Groups ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Groups'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Name ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## DisplayName ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## GRP_DPT_JUR&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## GRP_DPT_JUR&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Département Juridique&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field04&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## OU=Groups,OU=Paris,OU=Sites,OU=CORP,DC=corp,DC=priv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## If the Group exist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-ADGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The group &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-ADGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Description&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field04&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-GroupCategory&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GroupCategory&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-GroupScope&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GroupScope&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The group &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; was created&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;Break&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## End create Groups ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create Users ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Users'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## GivenName ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GivenName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;substring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;toupper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;substring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tolower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Surname ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SurName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ToUpper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## SamAccountName ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GivenNameFormat&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FormattingVar&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GivenName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SurNameFormat&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;FormattingVar&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SurName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GivenNameFormat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ToLower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SurNameFormat&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ToLower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Name ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SurName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GivenName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; (&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;)&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Password ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Password&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ConvertTo-SecureString&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-AsPlainText&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Password&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-force&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Email ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Email&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;@&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ExternalDomain&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## UserPrincipalName ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$UserPrincipalName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;@&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$LocalDomain&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## DisplayName ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Initials ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Initials&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;substring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;toupper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;substring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;toupper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## department group ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DepartmentGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field16&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Business group ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BusinessGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field17&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## DOE Jane&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GivenName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Jane&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SurName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## DOE&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field04&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## OU=Paris,OU=Sites,OU=CORP,DC=corp,DC=priv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Password&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## System.Security.SecureString&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Email&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## jane.doe@corporate.com&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## jane.doe&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$UserPrincipalName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## DOE Jane&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## DOE Jane&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field05&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Corporate&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field06&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Direction&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field07&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Chief executive officer&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field08&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## 110&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field09&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## +33 1 60 84 00 26&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## 75008&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field11&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Paris&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## 55 Rue du Faubourg Saint-Honoré&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Corporate User&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## OU=Users,OU=Paris,OU=Sites,OU=CORP,DC=corp,DC=priv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## FR&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DepartmentGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## GRP_DPT_DIR&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BusinessGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## GRP_MET_DIR&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;


                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADUserExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-ADUser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADUserExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The user &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-ADuser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-GivenName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GivenName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Surname&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SurName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field04&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-AccountPassword&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Password&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-EmailAddress&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Email&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-UserPrincipalName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$UserPrincipalName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DisplayName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Company&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field05&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Department&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field06&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Title&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field07&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Office&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field08&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-OfficePhone&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field09&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-PostalCode&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field10&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-City&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field11&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-StreetAddress&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field12&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Description&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field13&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Country&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field15&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Initials&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Initials&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Enabled&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CannotChangePassword&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-PasswordNeverExpires&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Set-ADUser&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Identity&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                            &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Manager&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field14&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## If the Departement Group exist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExistDep&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-ADGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DepartmentGroup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExistDep&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add-ADGroupMember&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DepartmentGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Members&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                        &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## If the Business Group exist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExistBus&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-ADGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BusinessGroup&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADGroupExistBus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                            &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Add-ADGroupMember&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BusinessGroup&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Members&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The user &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; was created&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;Break&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## End create Users ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Start create Computers ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Computers'&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Name ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## SamAccountName ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field02&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## DNSHostName ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DNSHostName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Domain&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## WD01&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## WD01&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DNSHostName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## OU=Computers,OU=Paris,OU=Sites,OU=CORP,DC=corp,DC=priv&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OperatingSystem&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## Windows 10 Enterprise&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Verbose&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OperatingSystemVersion&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## 10.0 (17763)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                    &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## If the Computer exist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADComputerExist&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Get-ADComputer&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;$null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;If&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ADComputerExist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The Computer &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; already exists&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;New-ADComputer&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$SamAccountName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DNSHostName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$DNSHostName&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Content&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;field03&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-OperatingSystem&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OperatingSystem&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;`
&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;                        &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-OperatingSystemVersion&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$OperatingSystemVersion&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The Computer &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$Name&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; was created&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;Break&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## End create Computers ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;

                &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# Start default switch #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Default&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                     &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Host&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;The file format is invalid&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
                &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# End default switch #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
            &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# End of switch #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;# End of foreach #&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;kr&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;Write-Error&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Could not find the file &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CSVFile&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;c&quot;&gt;## End to create Fake Company ##&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;GitHub :&lt;/strong&gt; &lt;a href=&quot;https://github.com/vlepineadm/FakeCompany&quot;&gt;Here is the link of the repository.&lt;/a&gt;&lt;/p&gt;</content><author><name>Valentin LÉPINE</name></author><category term="Powershell" /><category term="Windows" /><category term="Windows Server" /><category term="Microsoft" /><category term="AD" /><category term="Active Directory" /><category term="PS" /><category term="Powershell" /><category term="User" /><category term="Group" /><category term="OU" /><category term="Organizational Unit" /><category term="Computer" /><category term="CSV" /><category term="Comma-Separated Values" /><category term="Company" /><category term="Fake" /><category term="FakeCompany" /><category term="Powershell Module" /><category term="Module" /><category term="Github" /><category term="Repository" /><category term="Repo" /><summary type="html">While fessing tests in my lab, I got tired of creating users User01 groups, etc ... So I decided to create a script Powershell to create a similar structure to that of a company, allowing me to automatically create OUs, users, groups, computers, from a CSV file.</summary></entry><entry><title type="html">How to install Microsoft SQL Server 2016</title><link href="http://localhost:4000/sql/install-sql-server-2016/" rel="alternate" type="text/html" title="How to install Microsoft SQL Server 2016" /><published>2019-03-26T00:00:00+01:00</published><updated>2020-12-07T00:00:00+01:00</updated><id>http://localhost:4000/sql/install-sql-server-2016</id><content type="html" xml:base="http://localhost:4000/sql/install-sql-server-2016/">&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/logo-sql-222x150.png&quot; class=&quot;align-left&quot; /&gt;SQL server designates a database server. The definition of the SQL server is closely linked to that of &lt;strong&gt;SQL (Structured Query Language)&lt;/strong&gt;, a computer language that allows databases to be exploited. Microsoft SQL Server allows the operation of SQL and can create tables in a relational database, as well as add, modify or delete them.&lt;/p&gt;

&lt;h2 id=&quot;the-principles&quot;&gt;The principles&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Concretely, a SQL server is a tool that has all the characteristics to be able to accompany the user in the manipulation, the control, the sorting, the update, and many other actions still, of databases thanks to the language SQL .&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The term also refers to the name given to the &lt;strong&gt;Relational Database Management System (RDBMS)&lt;/strong&gt; marketed by Microsoft, or more precisely the name of the database engine of this RDBMS, SQL server offers multiple features.&lt;/p&gt;

&lt;h3 id=&quot;prerequisites&quot;&gt;Prerequisites&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Here are the minimum prerequisites for a server that host SQL Server 2016.&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Hardware&lt;/th&gt;
      &lt;th&gt;Specification&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;CPU :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;1.4 GHz 64-bit&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Memory :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;1024Mo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Hard disk :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;40Go disk space&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Network :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;A network connection&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;For this tutorial, I would use a virtual machine with &lt;strong&gt;Windows Server 2016 Standard&lt;/strong&gt; with the following configuration :&lt;/p&gt;

&lt;h3 id=&quot;hardware&quot;&gt;Hardware&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Hardware&lt;/th&gt;
      &lt;th&gt;Specification&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;CPU :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;4 vCPU&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;RAM :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;4Go&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Disque dur :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;C:\System 40Go, D:\Data 20Go&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Réseau :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;Host-only&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;network&quot;&gt;Network&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Champs&lt;/th&gt;
      &lt;th&gt;Values&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;IP address :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;192.168.100.101&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Subnet :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;255.255.255.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Default gateway :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;192.168.100.254&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;DNS :&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;192.168.100.100 (Active Directory server )&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;server-preparation&quot;&gt;Server preparation&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open the &lt;strong&gt;&quot;Server Manager&quot;&lt;/strong&gt;, the program launches at startup.&lt;/p&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Local Server&quot;&lt;/strong&gt; fill in the following settings.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-17-19_30_50.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Computer name :&lt;/strong&gt; give a meaningful name to your server, for my part, I would take for example : &lt;strong&gt;CORPWSQL1&lt;/strong&gt;.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Windows Firewall :&lt;/strong&gt; disable Windows Firewall.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Remote Desktop :&lt;/strong&gt; enable remote desktop.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Ethernet0 :&lt;/strong&gt; set a fixed IP address, I would take for example : &lt;strong&gt;192.168.10.3&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p style=&quot;text-align: justify;&quot;&gt;
&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-17-19_32_02.png&quot; class=&quot;align-center&quot; /&gt;
&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;notice--warning&quot;&gt;It is recommended by Microsot to perform all updates before any roles are installed.&lt;/span&gt;&lt;/p&gt;

&lt;h2 id=&quot;installing-prerequisites&quot;&gt;Installing prerequisites&lt;/h2&gt;

&lt;h3 id=&quot;preparing-for-access-rights&quot;&gt;Preparing for access rights&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;On your Active Directory server, for me &lt;strong&gt;CORPWADS1&lt;/strong&gt;. And create a group and a user to administer the SQL server :
&lt;ul&gt;
  &lt;li&gt;Group : &lt;strong&gt;GRP_SQL_Admins&lt;/strong&gt; : 
    &lt;ul&gt;
      &lt;li&gt;Group scope &lt;strong&gt;&quot;Global&quot;&lt;/strong&gt;&lt;/li&gt; 
      &lt;li&gt;Group type &lt;strong&gt;&quot;Security&quot;&lt;/strong&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Users : &lt;strong&gt;SVC_SQL_Adm&lt;/strong&gt; : 
    &lt;ul&gt;
      &lt;li&gt;For security reasons activate options : &lt;strong&gt;&quot;User cannot change password&quot;&lt;/strong&gt;&lt;/li&gt; 
      &lt;li&gt;Check also this option : &lt;strong&gt;&quot;Password never expires&quot;&lt;/strong&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_03_11-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;server-preparation-1&quot;&gt;Server preparation&lt;/h3&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Then on your future SQL server, open the &lt;strong&gt;&quot;Start Menu&quot;&lt;/strong&gt;. Click on &lt;strong&gt;&quot;Windows PowerShell&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-21_03_11-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Run the following command to install the &lt;strong&gt;.NET Framework 3.5&lt;/strong&gt; and the &lt;strong&gt;.NET Framework 4.6&lt;/strong&gt; :&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;Install-WindowsFeature&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;NET-Framework-Features&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Source&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;D:\sources\sxs&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-21_05_11-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;To make sure the features are installed, run the next command :&lt;/p&gt;
&lt;div class=&quot;language-powershell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nf&quot;&gt;Get-WindowsFeature&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NET-Framework-Core&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;NET-Framework-45-Features&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-21_07_11-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;installing-sql-server-2016&quot;&gt;Installing SQL Server 2016&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Open the ISO of the SQL Server 2016 installation and click &lt;strong&gt;&quot;setup&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_04_33-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;In the menu on the left click &lt;strong&gt;&quot;Install&quot;&lt;/strong&gt;. In the right window, click on &lt;strong&gt;&quot;New SQL Server stand-alone installation or add features to an existing installation&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_05_50-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Product Key :&lt;/strong&gt; select &lt;strong&gt;&quot;Enter the product key:&quot;&lt;/strong&gt; and enter your &lt;strong&gt;Key&lt;/strong&gt;. &lt;br /&gt;Then click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_06_19-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;License Terms :&lt;/strong&gt; accept the license agreement by checking the box &lt;strong&gt;&quot;I accept the license terms.&quot;&lt;/strong&gt;. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_06_33-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Global Rules :&lt;/strong&gt; the assistant checks the requirements. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_06_54-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Microsoft Update :&lt;/strong&gt; check the &lt;strong&gt;&quot;Use Microsoft Update to check for updates (recommended)&quot;&lt;/strong&gt; box to check for product updates. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_07_44-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Product Updates :&lt;/strong&gt; the assistant lists the updates that will be installed. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_08_10-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Install Rules :&lt;/strong&gt; if all the rules are complete, click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_10_05-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Feature Selection : &lt;/strong&gt; select the following options for &lt;strong&gt;&quot;Database Engine Services&quot;&lt;/strong&gt;, &lt;strong&gt;&quot;Reporting Services - Native&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_12_04-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Instance Configuration :&lt;/strong&gt; in this part, you can edit the name of the instance if you wish. Click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_14_40-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Server Configuration :&lt;/strong&gt; learn about the following fields with the previously created &lt;strong&gt;SVC_SQL_Adm&lt;/strong&gt; account created previously :&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;&quot;SQL Server Agent&quot;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&quot;SQL Server Database Engine&quot;&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;&quot;SQL Server Reporting Services&quot;&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_18_40-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Database Engine Configuration :&lt;/strong&gt; select the &lt;strong&gt;&quot;Windows authentification mode&quot;&lt;/strong&gt; option and add the group created &lt;strong&gt;GRP_SQL_Admins&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_21_42-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Reporting Services Configuration :&lt;/strong&gt; select &lt;strong&gt;&quot;Install and configure&quot;&lt;/strong&gt; and click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_22_06-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Feature Configuration Rules :&lt;/strong&gt; once all the checks have been completed, click on &lt;strong&gt;&quot;Next &amp;gt;&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_22_26-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Ready to Install :&lt;/strong&gt; a summary of the components that will be installed will appear, click on &lt;strong&gt;&quot;Install&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_22_42-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Installation Progress :&lt;/strong&gt; the installation begins.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_36_12-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;&lt;strong&gt;Complete :&lt;/strong&gt; the installation is finished, the assistant displays the setup information. Click on &lt;strong&gt;&quot;Close&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_38_20-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;installing-microsoft-sql-server-management-studio&quot;&gt;Installing Microsoft SQL Server Management Studio&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Download SSMS from the Microsoft website at the following address : &lt;a href=&quot;https://go.microsoft.com/fwlink/?linkid=2088649&amp;amp;clcid=0x409&quot; alt=&quot;Lien SSMS&quot;&gt;download&lt;/a&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Run the setup &lt;strong&gt;&quot;SSMS-Setup-ENU.exe&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_48_41-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on &lt;strong&gt;&quot;Install&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_49_00-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The installation is progressing.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_56_14-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Once the installation is complete, click on &lt;strong&gt;&quot;Restart&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_57_42-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;connect-to-microsoft-sql-server-2016&quot;&gt;Connect to Microsoft SQL Server 2016&lt;/h2&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Click on the icon &lt;strong&gt;&quot;Microsoft SQL Server Management Studio 17&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-22_59_41-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;Managment Studio starts.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-23_00_23-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;A connection window appears. As the login information was pre-filled with the information from the connected Windows account, all that remained was to click on &lt;strong&gt;&quot;Connect&quot;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-23_01_28-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;The connection to the server is now OK. In the &lt;strong&gt;&quot;Object Explorer&quot;&lt;/strong&gt; and &lt;strong&gt;&quot;Databases&quot;&lt;/strong&gt; window you will be able to see your server databases.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/assets/images/posts/2019-03-26-install-sql-server-2016/2019-02-26-23_03_33-1.png&quot; class=&quot;align-center&quot; /&gt;&lt;/p&gt;

&lt;p style=&quot;text-align: justify;&quot;&gt;There you go ! It's up to you to enjoy your Microsoft SQL Server 2016.&lt;/p&gt;</content><author><name>Valentin LÉPINE</name></author><category term="SQL" /><category term="Windows" /><category term="SQL" /><category term="SQL Server" /><category term="SQL Server 2016" /><category term="Microsoft" /><category term="Server" /><category term="Structured Query Language" /><category term="RDBMS" /><category term="Relational Database Management System" /><category term="Language SQL" /><category term="Powershell" /><category term=".NET Framework 3.5" /><category term=".NET Framework 4.6" /><category term="Stand-alone" /><category term="Microsoft Update" /><category term="Database Engine Services" /><category term="Reporting Services" /><category term="Instance" /><category term="SQL Server Agent" /><category term="SQL Server Database Engine" /><category term="SQL Server Reporting Services" /><category term="Microsoft SQL Server Management Studio" /><category term="SSMS" /><category term="SQL Server Management Studio" /><category term="Authentification" /><category term="Databases" /><summary type="html">SQL server designates a database server. The definition of the SQL server is closely linked to that of SQL (Structured Query Language), a computer language that allows databases to be exploited. Microsoft SQL Server allows the operation of SQL and can create tables in a relational database, as well as add, modify or delete them.</summary></entry></feed>